!function(t){var e={};function i(s){if(e[s])return e[s].exports;var n=e[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:s})},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=13)}([function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class s{constructor(t,e){this.x=t,this.y=e}static addVector(t,e){return new s(t.x+e.x,t.y+e.y)}static subtractVector(t,e){return new s(t.x-e.x,t.y-e.y)}static multiply(t,e){return new s(t.x*e,t.y*e)}static divide(t,e){if(0===e)throw new Error('cannot divide vector by scalar with value "0"');return new s(t.x/e,t.y/e)}set x(t){this._x=t}set y(t){this._y=t}get x(){return this._x}get y(){return this._y}set(t,e){this.x=t,this.y=e}setVector(t){this.x=t.x,this.y=t.y}add(t,e){this.x+=t,this.y+=e}addVector(t){this.x+=t.x,this.y+=t.y}subtract(t,e){this.x-=t,this.y-=e}subtractVector(t){this.x-=t.x,this.y-=t.y}multiply(t){this.x*=t,this.y*=t}divide(t){if(0===t)throw new Error('cannot divide vector by "0"');this.x/=t,this.y/=t}mag(){return Math.sqrt(this.x*this.x+this.y*this.y)}negative(){return new s(-this.x,-this.y)}normalize(){let t=this.mag();0!==t&&this.divide(t)}limit(t){Math.floor(this.mag())>t&&(this.normalize(),this.multiply(t))}distanceTo(t){return Math.sqrt(Math.pow(t.x-this.x,2)+Math.pow(t.y-this.y,2))}dot(t){return this.x*t.x+this.y*t.y}floor(){this.x=Math.floor(this.x),this.x=Math.floor(this.x)}clone(){return new s(this.x,this.y)}}e.Vector2=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});(s=e.EntityType||(e.EntityType={})).PLAYER="ship",s.ENEMY="enmey",s.ENEMY_BULLET="bulletEnemy",s.PLAYER_BULLET="bullet",s.BACKGROUND="background",s.MAP="map",s.GAME_OVER="gameOver",s.LASER="laser",s.MAIN_THEME="shockWave",s.EXPLOSION_I="explosion1",s.EXPLOSION_II="explosion2",s.BOX="BOX";var s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(8);(n=e.Actions||(e.Actions={})).UP="UP",n.DOWN="DOWN",n.LEFT="LEFT",n.RIGHT="RIGHT",n.SHOOT="SHOOT",n.RESTART="RESTART";var n;e.InputManager=class extends s.Observable{constructor(t){super(),this.inputMap=t.keyBoard,this.init(),this.initializeTouchHandler(),this.touches={start:[],move:[]}}init(){window.addEventListener("keydown",t=>{let e=" "!==t.key?t.key:"space";this.state[this.inputMap[e]]=!0,this.notify()}),window.addEventListener("keyup",t=>{let e=" "!==t.key?t.key:"space";this.state[this.inputMap[e]]=!1,this.notify()})}initializeTouchHandler(){let t=document.getElementById("move"),e=t||window;e.addEventListener("touchstart",l,!1),e.addEventListener("touchmove",d,!1),e.addEventListener("touchend",c,!1),e.addEventListener("contextmenu",t=>(t.preventDefault(),!1));let i=[],s=[],n=0,o=0,h=0,a=0,r=this;function l(t){t.preventDefault(),i=t.touches,n=t.touches[0].pageX,o=t.touches[0].pageY}function d(t){r.reset(),t.preventDefault(),s=t.changedTouches,h=t.touches[0].pageX,a=t.touches[0].pageY;for(let e=0;e<t.touches.length;e++)s[e].pageX<i[e].pageX&&(r.state[r.inputMap.a]=!0),s[e].pageX>i[e].pageX&&(r.state[r.inputMap.d]=!0),s[e].pageY<i[e].pageY&&(r.state[r.inputMap.w]=!0),s[e].pageY>i[e].pageY&&(r.state[r.inputMap.s]=!0),r.notify()}function c(t){t.preventDefault(),r.reset()}}shoot(){this.state[this.inputMap.space]=!0}cancelShoot(){this.state[this.inputMap.space]=!1}reset(){this.state[this.inputMap.w]=!1,this.state[this.inputMap.a]=!1,this.state[this.inputMap.s]=!1,this.state[this.inputMap.d]=!1}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(5),n=i(6),o=i(7);var h;(a=h=e.AssetType||(e.AssetType={})).SPRITE="SPRITE",a.SPRITE_SHEET="SPRITE_SHEET",a.AUDIO="AUDIO",a.AUDIO_LOOP="LOOP";var a;e.AssetManager=class{constructor(){this.cache={sprites:{},spriteSheets:{},audio:{}},this.downloadCount=0,this.queue=[],this.initAudioContext()}initAudioContext(){try{window.AudioContext=window.AudioContext||webkitAudioContext,this.audioContext=new AudioContext,this.masterGain=this.audioContext.createGain(),this.effectsGain=this.audioContext.createGain(),this.ambientGain=this.audioContext.createGain(),this.masterGain.gain.value=1,this.masterGain.connect(this.audioContext.destination),this.effectsGain.connect(this.masterGain),this.ambientGain.connect(this.masterGain),this.ambientGain.gain.value=1,this.effectsGain.gain.value=1}catch(t){console.log("Web Audio API is not supported in this browser")}}adjustMasterVolume(t){this.masterGain.gain.value=t}adjustAmbientVolume(t){this.ambientGain.gain.value=t}adjustEffectsVolume(t){this.effectsGain.gain.value=t}done(){return this.downloadCount===this.queue.length}queueDownload(t,e,i,s=null){this.queue.push({id:t,path:e,type:i,opts:s})}loadAudioFromUrl(t,e){o.Ajax.create({method:"GET",url:t.path,responseType:"arraybuffer"},i=>{this.decodeAudio(i,t.id,e)})}decodeAudio(t,e,i){this.audioContext.decodeAudioData(t).then(t=>{this.cache.audio[e]=t,this.downloadCount+=1,this.done()&&i()},t=>{console.log("Error with decoding audio data"+t)})}loadSprite(t,e){let i=new Image;i.addEventListener("load",()=>{this.downloadCount++,this.done()&&e()}),i.src=t.path,this.cache.sprites[t.id]=i}loadSpriteSheet(t,e){let i=new Image;i.addEventListener("load",()=>{this.cache.spriteSheets[t.id]=new s.SpriteSheet(i,t.opts.frameWidth||0,t.opts.frameHeight||0),this.downloadCount+=1,this.done()&&e()}),i.src=t.path}downloadAll(t){this.queue.forEach(e=>{e.type===h.AUDIO?this.loadAudioFromUrl(e,t):e.type===h.SPRITE?this.loadSprite(e,t):e.type===h.SPRITE_SHEET&&this.loadSpriteSheet(e,t)})}getSound(t,e){let i;return i=e===h.AUDIO?this.effectsGain:this.ambientGain,new n.Sound(this.audioContext,i,this.cache.audio[t])}getSprite(t){return this.cache.sprites[t]}getSpriteSheet(t){return this.cache.spriteSheets[t]}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(0),n=i(1);e.HitBox=class{constructor(t,e,i,o){this.position=new s.Vector2(t,e),this.width=i,this.height=o,this.colliding=!1,this.collidesWith=[],this.type=n.EntityType.BOX,this.collidesWith.push(n.EntityType.PLAYER)}isCollideAbleWith(t){return this.collidesWith.includes(t.type.toString())}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.SpriteSheet=class{constructor(t,e,i){this._image=t,this._frameWidth=e,this._frameHeight=i,this._framesPerRow=Math.floor(this._image.width/this._frameWidth)}get image(){return this._image}set image(t){if(!(t instanceof Image))throw new Error("Param tileSetImage must be of type Image!");this._image=t}get frameWidth(){return this._frameWidth}set frameWidth(t){this._frameWidth=t}get frameHeight(){return this._frameHeight}set frameHeight(t){this._frameHeight=t}get framesPerRow(){return this._framesPerRow}set framesPerRow(t){this._framesPerRow=t}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.Sound=class{constructor(t,e,i){this.audioContext=t,this.masterGain=e,this.buffer=i,this.gainNode=this.audioContext.createGain(),this.gainNode.gain.value=.2,this.gainNode.connect(this.masterGain),this.playing=!1}play(t=!1){this.source=this.audioContext.createBufferSource(),this.source.buffer=this.buffer,this.source.loop=t,this.source.connect(this.gainNode),this.source.start(0)}stop(){this.source.stop(0)}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class s{static create(t,e){let i=new XMLHttpRequest;i.addEventListener("load",()=>{e(i.response)}),i.open(t.method?t.method:s.defaults.method,t.url?t.url:s.defaults.url,t.async?t.async:s.defaults.async),t.hasOwnProperty("contentType")&&i.setRequestHeader("Content-Type",t.contentType?t.contentType:s.defaults.contentType),t.hasOwnProperty("responseType")&&(i.responseType=t.responseType),t.hasOwnProperty("data")&&"object"==typeof t.data&&(t.data=JSON.stringify(t.data)),i.send(t.data?t.data:null)}}s.defaults={url:"",method:"GET",contentType:"text/html",async:!0,data:null},e.Ajax=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.Observable=class{constructor(){this._observers=[],this._state={}}register(t){this._observers.push(t)}unRegister(t){this._observers=this._observers.filter(e=>e!==t)}notify(){this._observers.forEach(t=>{t.update(this._state)})}get observers(){return this._observers}set observers(t){this._observers=t}get state(){return this._state}set state(t){this._state=t}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(4);class n{constructor(t=new s.HitBox(0,0,0,0),e=0){this.level=e,this.maxObjects=10,this.maxLevels=5,this.hitBox=t,this.objects=[],this.nodes=[]}clear(){this.objects=[],this.nodes.forEach(t=>t.clear()),this.nodes=[]}getAllObjects(t){return this.nodes.forEach(e=>e.getAllObjects(t)),this.objects.forEach(e=>t.push(e)),t}findObjects(t,e){if(void 0===e)return void console.log("UNDEFINED OBJECT");let i=this.getIndex(e);return-1!==i&&this.nodes.length&&this.nodes[i].findObjects(t,e),this.objects.forEach(e=>t.push(e)),t}insert(t){if(void 0!==t)if(t instanceof Array)t.forEach(t=>this.insert(t));else{if(this.nodes.length>0){let e=this.getIndex(t);if(-1!==e)return void this.nodes[e].insert(t)}if(this.objects.push(t),this.objects.length>this.maxObjects&&this.level<this.maxLevels){void 0===this.nodes[0]&&this.split();let t=0;for(;t<this.objects.length;){let e=this.getIndex(this.objects[t]);-1!==e?this.nodes[e].insert(this.objects.splice(t,1)[0]):t++}}}}getIndex(t){let e=-1,i=this.hitBox.position.x+this.hitBox.width/2,s=this.hitBox.position.y+this.hitBox.height/2,n=t.position.y<s&&t.position.y+t.height<s,o=t.position.y>s;return t.position.x<i&&t.position.x+t.width<i?n?e=1:o&&(e=2):t.position.x>i&&(n?e=0:o&&(e=3)),e}split(){let t=this.hitBox.width/2|0,e=this.hitBox.height/2|0;this.nodes[0]=new n(new s.HitBox(this.hitBox.position.x+t,this.hitBox.position.y,t,e),this.level+1),this.nodes[1]=new n(new s.HitBox(this.hitBox.position.x,this.hitBox.position.y,t,e),this.level+1),this.nodes[2]=new n(new s.HitBox(this.hitBox.position.x,this.hitBox.position.y+e,t,e),this.level+1),this.nodes[3]=new n(new s.HitBox(this.hitBox.position.x+t,this.hitBox.position.y+e,t,e),this.level+1)}}e.QuadTree=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.CollisionManager=class{constructor(t){this.quadTree=t}detectCollision(){let t=[];this.quadTree.getAllObjects(t);for(let e=0;e<t.length;e++){let i=[];this.quadTree.findObjects(i,t[e]);for(let s=0;s<i.length;s++)t[e].isCollideAbleWith(i[s])&&Math.floor(t[e].position.x)<Math.floor(i[s].position.x)+i[s].width&&Math.floor(t[e].position.x)+t[e].width>Math.floor(i[s].position.x)&&Math.floor(t[e].position.y)<Math.floor(i[s].position.y)+i[s].height&&Math.floor(t[e].position.y)+t[e].height>Math.floor(i[s].position.y)&&(t[e].colliding=!0,i[s].colliding=!0)}}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(2);e.Settings=class{constructor(){this.keyBoard={w:s.Actions.UP,s:s.Actions.DOWN,a:s.Actions.LEFT,d:s.Actions.RIGHT,space:s.Actions.SHOOT,r:s.Actions.RESTART},this.player={maxVelocity:15,fireDelay:15,friction:.7,acceleration:3},this.audio={master:1,ambient:1,effects:1}}findKey(t){return Object.keys(this.keyBoard).filter(e=>this.keyBoard[e]===t)[0]}setKey(t,e){let i=this.findKey(e);t!==i&&(console.log("old:"+i," new: "+t+" value: "+e),this.keyBoard[t]=this.keyBoard[i],delete this.keyBoard[i])}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.EventHandler=class{static registerOnElement(t,e,i){e.forEach(e=>t.addEventListener(e,i))}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(3),n=i(14),o=i(2),h=i(11),a=i(20),r=i(1),l=i(12),d=new s.AssetManager,c={background:document.getElementById("background"),ship:document.getElementById("ship"),main:document.getElementById("main")},u=new h.Settings,p=new o.InputManager(u),y=new a.SettingsMenu(document.getElementById("settings-menu"),u,d);d.queueDownload(r.EntityType.BACKGROUND,"assets/textures/background.png",s.AssetType.SPRITE),d.queueDownload(r.EntityType.PLAYER,"assets/sprites/ship.png",s.AssetType.SPRITE),d.queueDownload(r.EntityType.PLAYER_BULLET,"assets/sprites/bullet.png",s.AssetType.SPRITE),d.queueDownload(r.EntityType.ENEMY,"assets/sprites/enemy.png",s.AssetType.SPRITE),d.queueDownload(r.EntityType.ENEMY_BULLET,"assets/sprites/bullet_enemy.png",s.AssetType.SPRITE),d.queueDownload(r.EntityType.MAIN_THEME,"assets/audio/kick_shock.wav",s.AssetType.AUDIO),d.queueDownload(r.EntityType.LASER,"assets/audio/laser.wav",s.AssetType.AUDIO),d.queueDownload(r.EntityType.EXPLOSION_I,"assets/audio/explosion.wav",s.AssetType.AUDIO),d.queueDownload(r.EntityType.GAME_OVER,"assets/audio/game_over.wav",s.AssetType.AUDIO),d.downloadAll(()=>{const t=new n.SpaceGame(d,p,u,c);y.init();let e=document.getElementById("game-over"),i=document.getElementById("settings"),s=document.getElementById("shoot"),o=["click","touchstart"];s.addEventListener("touchstart",()=>p.shoot()),s.addEventListener("touchend",()=>p.cancelShoot()),s.addEventListener("contextmenu",t=>(t.preventDefault(),!1)),l.EventHandler.registerOnElement(e,o,()=>t.restart()),l.EventHandler.registerOnElement(i,o,()=>{y.toggleShow(),t.togglePause()})})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(15),n=i(3),o=i(2),h=i(16),a=i(17),r=i(9),l=i(4),d=i(1),c=i(10);e.SpaceGame=class{constructor(t,e,i,o){this.playing=!1,this.paused=!1,this.window=window,this.assetManager=t,this.inputManager=e,this.settings=i,this.canvases=o,this.canvases.background.getContext&&(this.backgroundContext=this.canvases.background.getContext("2d"),this.shipContext=this.canvases.ship.getContext("2d"),this.mainContext=this.canvases.main.getContext("2d"),this.playerScore=0,this.background=new s.Background(0,0,this.canvases.background.width,this.canvases.background.height,this.backgroundContext,this.assetManager.getSprite(d.EntityType.BACKGROUND)),this.shipStartX=this.canvases.ship.width/2-t.getSprite(d.EntityType.PLAYER).width,this.shipStartY=this.canvases.ship.height/4*3+2*t.getSprite(d.EntityType.PLAYER).height,this.ship=new h.Ship(this.shipStartX,this.shipStartY,t.getSprite(d.EntityType.PLAYER).width,t.getSprite(d.EntityType.PLAYER).height,this.canvases.ship.width,this.canvases.ship.height,this.shipContext,t,new a.Pool(t,this.mainContext,this.canvases.main.width,this.canvases.main.height,80,d.EntityType.PLAYER_BULLET),i.player),this.enemyBulletPool=new a.Pool(t,this.mainContext,this.canvases.main.width,this.canvases.main.height,50,d.EntityType.ENEMY_BULLET),this.enemyPool=new a.Pool(t,this.mainContext,this.canvases.main.width,this.canvases.main.height,30,d.EntityType.ENEMY,this.enemyBulletPool,this),this.spawnWave(),e.register(this.ship),e.register(this),this.quadTree=new r.QuadTree(new l.HitBox(0,0,this.canvases.main.width,this.canvases.main.height)),this.collisionManager=new c.CollisionManager(this.quadTree),this.backgroundAudio=this.assetManager.getSound(d.EntityType.MAIN_THEME,n.AssetType.AUDIO_LOOP),this.backgroundAudio.play(!0),this.start())}togglePause(){this.paused=!this.paused}spawnWave(){const t=this.assetManager.getSprite(d.EntityType.ENEMY).height,e=this.assetManager.getSprite(d.EntityType.ENEMY).width;let i=200,s=-t;const n=1.5*s;for(let t=1;t<=21;t++)this.enemyPool.get(i,s,4),i+=e+25,t%7==0&&(i=200,s+=n)}render(){this.playing&&(this.paused||(document.getElementById("score").innerHTML=this.playerScore.toString(),this.quadTree.clear(),this.quadTree.insert(this.ship),this.quadTree.insert(this.ship.pool.getPool()),this.quadTree.insert(this.enemyPool.getPool()),this.quadTree.insert(this.enemyBulletPool.getPool()),this.collisionManager.detectCollision(),0===this.enemyPool.getPool().length&&this.spawnWave(),this.ship.alive()?(this.background.draw(),this.ship.move(),this.ship.pool.render(),this.enemyPool.render(),this.enemyBulletPool.render()):(this.playing=!1,this.gameOver())),this.animReqID=window.requestAnimationFrame(()=>this.render()))}scorePoints(){this.playerScore+=10}update(t){t[o.Actions.RESTART]&&this.restart()}start(){this.playing=!0,this.render(),this.ship.draw()}gameOver(){this.backgroundAudio.stop(),document.getElementById("game-over").style.display="block",this.gameOverAudio=this.assetManager.getSound(d.EntityType.GAME_OVER,n.AssetType.AUDIO_LOOP),this.gameOverAudio.play(!0)}restart(){this.playing?(window.cancelAnimationFrame(this.animReqID),this.playing=!1,this.backgroundAudio.stop(),this.backgroundAudio.play(!0)):(this.gameOverAudio.stop(),this.backgroundAudio.play(!0),document.getElementById("game-over").style.display="none"),this.backgroundContext.clearRect(0,0,this.canvases.background.width,this.canvases.background.height),this.shipContext.clearRect(0,0,this.canvases.ship.width,this.canvases.ship.height),this.mainContext.clearRect(0,0,this.canvases.main.width,this.canvases.main.height),this.quadTree.clear(),this.background.reset(),this.playerScore=0,this.ship.reset(),this.enemyBulletPool.clearAll(),this.enemyPool.clearAll(),this.ship.pool.clearAll(),this.start()}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(0),n=i(1);e.Background=class{constructor(t,e,i,o,h,a){this.position=new s.Vector2(t,e),this.speed=1,this.width=i,this.height=o,this.canvasWidth=i,this.canvasHeight=o,this.context=h,this.sprite=a,this.type=n.EntityType.BACKGROUND}reset(){this.position.set(0,0)}draw(){this.position.y+=this.speed,this.context.drawImage(this.sprite,this.position.x,this.position.y),this.context.drawImage(this.sprite,this.position.x,this.position.y-this.height),this.position.y>=this.height&&(this.position.y=0)}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(0),n=i(1),o=i(2),h=i(3);e.Ship=class{constructor(t,e,i,o,a,r,l,d,c,u){this.position=new s.Vector2(t,e),this.startPosition=new s.Vector2(t,e),this.acceleration=new s.Vector2(0,0),this.velocity=new s.Vector2(0,0),this.width=i,this.height=o,this.canvasWidth=a,this.canvasHeight=r,this.context=l,this.sprite=d.getSprite(n.EntityType.PLAYER),this.type=n.EntityType.PLAYER,this.pool=c,this.counter=0,this.collidesWith=[],this.collidesWith.push(n.EntityType.ENEMY_BULLET),this.colliding=!1,this.state={},this.settings=u,this.maxTop=Math.floor(this.canvasHeight/4*3),this.laserSound=d.getSound(n.EntityType.LASER,h.AssetType.AUDIO)}reset(){this.position.setVector(this.startPosition),this.velocity.set(0,0),this.colliding=!1}move(){this.colliding||(this.counter++,this.context.clearRect(Math.floor(this.position.x),Math.floor(this.position.y),this.width,this.height),this.acceleration.set(0,0),this.state[o.Actions.LEFT]&&this.acceleration.add(-this.settings.acceleration,0),this.state[o.Actions.RIGHT]&&this.acceleration.add(this.settings.acceleration,0),this.state[o.Actions.UP]&&this.acceleration.add(0,-this.settings.acceleration),this.state[o.Actions.DOWN]&&this.acceleration.add(0,this.settings.acceleration),this.velocity.multiply(this.settings.friction),this.velocity.addVector(this.acceleration),this.velocity.limit(this.settings.maxVelocity),this.position.addVector(this.velocity),this.position.x<=0&&(this.position.x=0,this.velocity.x+=-1),this.position.x>=this.canvasWidth-this.width&&(this.position.x=this.canvasWidth-this.width),this.position.y<=this.maxTop&&(this.position.y=this.maxTop),this.position.y>=this.canvasHeight-this.height&&(this.position.y=this.canvasHeight-this.height),this.draw(),this.state[o.Actions.SHOOT]&&this.counter>=this.settings.fireDelay&&!this.colliding&&(this.fire(),this.counter=0))}alive(){return!this.colliding}draw(){this.context.drawImage(this.sprite,Math.floor(this.position.x),Math.floor(this.position.y))}update(t){this.state=t}fire(){this.pool.getTwo(Math.floor(this.position.x)+12,Math.floor(this.position.y),6,Math.floor(this.position.x)+66,Math.floor(this.position.y),6),this.laserSound.play()}isCollideAbleWith(t){return this.collidesWith.includes(t.type.toString())}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(18),n=i(19),o=i(1);e.Pool=class{constructor(t,e,i,s,n,o,h=null,a=null){this.assetManager=t,this.context=e,this.canvasWidth=i,this.canvasHeight=s,this.maxSize=n,this.type=o,this.pool=[],this.subPool=h,this.game=a,this.init()}init(){if(this.type===o.EntityType.ENEMY){let t=this.assetManager.getSprite(this.type);for(let e=0;e<this.maxSize;e++)this.pool[e]=new n.Enemy(0,0,t.width,t.height,this.canvasWidth,this.canvasHeight,0,this.context,t,this.type,this.subPool,this.game)}else for(let t=0;t<this.maxSize;t++){let e=this.assetManager.getSprite(this.type);this.pool[t]=new s.Bullet(0,0,e.width,e.height,this.canvasWidth,this.canvasHeight,0,this.context,e,this.type)}}get(t,e,i){let s=this.pool[this.maxSize-1];s.alive||(s.spawn(t,e,i),this.pool.unshift(this.pool.pop()))}getTwo(t,e,i,s,n,o){this.pool[this.maxSize-1].alive||this.pool[this.maxSize-2].alive||(this.get(t,e,i),this.get(s,n,o))}render(){for(let t=0;t<this.pool.length&&this.pool[t].alive;t++)this.pool[t].draw()&&(this.pool[t].clear(),this.pool.push(this.pool.splice(t,1)[0]))}clearAll(){this.pool.forEach(t=>t.clear())}getPool(){let t=[];return this.pool.forEach(e=>{e.alive&&t.push(e)}),t}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(0),n=i(1);e.Bullet=class{constructor(t,e,i,o,h,a,r,l,d,c){this.position=new s.Vector2(t,e),this.speed=r,this.width=i,this.height=o,this.canvasWidth=h,this.canvasHeight=a,this.context=l,this.sprite=d,this.alive=!1,this.type=c,this.colliding=!1,this.collidesWith=[],this.type===n.EntityType.PLAYER_BULLET?this.collidesWith.push(n.EntityType.ENEMY):this.type===n.EntityType.ENEMY_BULLET&&this.collidesWith.push(n.EntityType.PLAYER)}spawn(t,e,i){this.position.set(t,e),this.speed=i,this.alive=!0}draw(){return this.context.clearRect(this.position.x-1,this.position.y-1,this.width+1,this.height+1),this.position.y-=this.speed,!!this.colliding||this.type===n.EntityType.PLAYER_BULLET&&this.position.y<=0-this.height||this.type===n.EntityType.ENEMY_BULLET&&this.position.y>=this.canvasHeight||(this.context.drawImage(this.sprite,this.position.x,this.position.y),!1)}clear(){this.position.set(0,0),this.speed=0,this.alive=!1,this.colliding=!1}isCollideAbleWith(t){return this.collidesWith.includes(t.type.toString())}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(0),n=i(1),o=i(3);e.Enemy=class{constructor(t,e,i,h,a,r,l,d,c,u,p,y){this.position=new s.Vector2(t,e),this.width=i,this.height=h,this.canvasWidth=a,this.canvasHeight=r,this.speed=l,this.context=d,this.sprite=c,this.percentFire=.001,this.chance=0,this.alive=!1,this.type=u,this.collidesWith=[],this.collidesWith.push(n.EntityType.PLAYER_BULLET),this.colliding=!1,this.bulletPool=p,this.game=y,this.explosionSound=this.game.assetManager.getSound(n.EntityType.EXPLOSION_I,o.AssetType.AUDIO)}spawn(t,e,i){this.position.x=t,this.position.y=e,this.speed=i,this.speedX=0,this.speedY=i,this.alive=!0,this.leftEdge=this.position.x-180,this.rightEdge=this.position.x+180,this.bottomEdge=this.position.y+280}draw(){return this.context.clearRect(this.position.x-1,this.position.y,this.width+1,this.height),this.position.x+=this.speedX,this.position.y+=this.speedY,this.position.x<=this.leftEdge?this.speedX=this.speed:this.position.x>=this.rightEdge+this.width?this.speedX=-this.speed:this.position.y>=this.bottomEdge&&(this.speed=1.5,this.speedY=0,this.position.y-=5,this.speedX=-this.speed),this.colliding?(this.game.scorePoints(),this.explosionSound.play(),!0):(this.context.drawImage(this.sprite,this.position.x,this.position.y),this.chance=Math.floor(101*Math.random()),this.chance/100<this.percentFire&&this.fire(),!1)}fire(){this.bulletPool.get(Math.floor(this.position.x+this.width/2),Math.floor(this.position.y+this.height),-5)}clear(){this.position.x=0,this.position.y=0,this.speed=0,this.speedX=0,this.speedY=0,this.alive=!1,this.colliding=!1}isCollideAbleWith(t){return this.collidesWith.includes(t.type.toString())}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(2),n=i(12);e.SettingsMenu=class{constructor(t,e,i){this.element=t,this.settings=e,this.assetManager=i,this.showing=!1}createMainMenu(){this.mainMenu=document.createElement("div"),this.mainMenu.classList.add("tab"),this.element.appendChild(this.mainMenu)}openTab(t,e){let i,s;i=document.getElementsByClassName("tabContent");for(let t=0;t<i.length;t++)i[t].style.display="none";s=document.getElementsByClassName("tabLink");for(let t=0;t<s.length;t++)s[t].className=s[t].className.replace(" active","");document.getElementById(e).style.display="block",t.currentTarget.className+=" active"}createKeyboardMenu(){let t="keyboardMenu",e=document.createElement("button"),i=document.createElement("div"),o=document.createElement("h4"),h=document.createElement("form"),a=document.createElement("input");n.EventHandler.registerOnElement(e,["click","touchstart"],e=>this.openTab(e,t)),e.appendChild(document.createTextNode("Keyboard")),e.classList.add("tabLink"),this.mainMenu.appendChild(e),i.setAttribute("id",t),i.classList.add("tabContent"),o.appendChild(document.createTextNode("Keyboard")),h.setAttribute("id","keyboardSettings"),h.setAttribute("method","post"),a.setAttribute("type","submit"),a.setAttribute("value","Save"),i.appendChild(o),i.appendChild(h),this.element.appendChild(i),Object.keys(this.settings.keyBoard).forEach(t=>this.addEntry(t,h)),h.appendChild(a),h.addEventListener("submit",t=>{t.preventDefault(),this.settings.setKey(document.getElementById(s.Actions.UP).value,s.Actions.UP),this.settings.setKey(document.getElementById(s.Actions.DOWN).value,s.Actions.DOWN),this.settings.setKey(document.getElementById(s.Actions.LEFT).value,s.Actions.LEFT),this.settings.setKey(document.getElementById(s.Actions.RIGHT).value,s.Actions.RIGHT),this.settings.setKey(document.getElementById(s.Actions.SHOOT).value,s.Actions.SHOOT),this.settings.setKey(document.getElementById(s.Actions.RESTART).value,s.Actions.RESTART),this.clear()})}createPlayerMenu(){let t="playerMenu",e=document.createElement("button"),i=document.createElement("div"),s=document.createElement("h4"),o=document.createElement("form"),h=document.createElement("input");n.EventHandler.registerOnElement(e,["click","touchstart"],e=>this.openTab(e,t)),e.appendChild(document.createTextNode("Player")),e.classList.add("tabLink"),this.mainMenu.appendChild(e),i.setAttribute("id",t),i.classList.add("tabContent"),s.appendChild(document.createTextNode("Player Settings")),o.setAttribute("id","playerSettings"),o.setAttribute("method","post"),h.setAttribute("type","submit"),h.setAttribute("value","Save"),i.appendChild(s),i.appendChild(o),this.element.appendChild(i),Object.keys(this.settings.player).forEach(t=>this.addPlayerSettingEntry(t,o)),o.appendChild(h),o.addEventListener("submit",t=>{t.preventDefault(),this.settings.player.acceleration=Number(document.getElementById("acceleration").value),this.settings.player.maxVelocity=Number(document.getElementById("maxVelocity").value),this.settings.player.friction=Number(document.getElementById("friction").value),this.settings.player.fireDelay=Number(document.getElementById("fireDelay").value),this.clear()})}createAudioMenu(){let t="audioMenu",e=document.createElement("button"),i=document.createElement("div"),s=document.createElement("div"),o=document.createElement("h4"),h=document.createElement("label"),a=document.createElement("input");n.EventHandler.registerOnElement(e,["click","touchstart"],e=>this.openTab(e,t)),e.classList.add("tabLink"),e.appendChild(document.createTextNode("Audio")),this.mainMenu.appendChild(e),i.setAttribute("id",t),i.classList.add("tabContent"),s.classList.add("row"),o.appendChild(document.createTextNode("Audio Settings")),h.appendChild(document.createTextNode("Master Volume:")),h.setAttribute("for","masterVolume"),a.setAttribute("id","masterVolume"),a.setAttribute("type","range"),a.setAttribute("min","0"),a.setAttribute("max","1"),a.setAttribute("step","0.1"),a.addEventListener("change",t=>this.assetManager.adjustMasterVolume(Number(a.value))),s.appendChild(o),s.appendChild(h),s.appendChild(a),i.appendChild(s);let r=document.createElement("div"),l=document.createElement("label"),d=document.createElement("input");r.classList.add("row"),l.appendChild(document.createTextNode("Ambient Volume:")),l.setAttribute("for","ambientVolume"),d.setAttribute("id","ambientVolume"),d.setAttribute("type","range"),d.setAttribute("min","0"),d.setAttribute("max","1"),d.setAttribute("step","0.1"),d.addEventListener("change",t=>this.assetManager.adjustAmbientVolume(Number(d.value))),r.appendChild(l),r.appendChild(d),i.appendChild(r);let c=document.createElement("div"),u=document.createElement("label"),p=document.createElement("input");c.classList.add("row"),u.appendChild(document.createTextNode("Effects Volume:")),u.setAttribute("for","effectsVolume"),p.setAttribute("id","effectsVolume"),p.setAttribute("type","range"),p.setAttribute("min","0"),p.setAttribute("max","1"),p.setAttribute("step","0.1"),p.addEventListener("change",t=>this.assetManager.adjustEffectsVolume(Number(p.value))),c.appendChild(u),c.appendChild(p),i.appendChild(c),this.element.appendChild(i)}init(){this.createMainMenu(),this.createKeyboardMenu(),this.createPlayerMenu(),this.createAudioMenu()}clear(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.init()}addPlayerSettingEntry(t,e){let i=document.createElement("label"),s=document.createElement("input"),n=document.createElement("div");i.setAttribute("for",t),i.appendChild(document.createTextNode(t+":")),s.setAttribute("id",t),s.setAttribute("type","number"),s.setAttribute("name",t),s.setAttribute("value",this.settings.player[t]),n.classList.add("row"),n.appendChild(i),n.appendChild(s),e.appendChild(n)}addEntry(t,e){let i=document.createElement("div"),s=document.createElement("label"),n=document.createElement("input");i.classList.add("row"),s.setAttribute("for",this.settings.keyBoard[t]),s.appendChild(document.createTextNode(this.settings.keyBoard[t]+":")),n.setAttribute("id",this.settings.keyBoard[t]),n.setAttribute("type","text"),n.setAttribute("name",this.settings.keyBoard[t]),n.setAttribute("value",t),i.appendChild(s),i.appendChild(n),e.appendChild(i)}toggleShow(){this.showing?(this.element.style.display="none",this.showing=!1):(this.element.style.display="block",this.showing=!0)}}}]);
//# sourceMappingURL=multiverseInvaders.min.js.map