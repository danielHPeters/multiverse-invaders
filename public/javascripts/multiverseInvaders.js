!function(t){var e={};function i(s){if(e[s])return e[s].exports;var n=e[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:s})},i.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=28)}([function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.PLAYER="ship",t.ENEMY="enemy",t.ENEMY_BULLET="bulletEnemy",t.PLAYER_BULLET="bullet",t.BACKGROUND="background",t.MAP="map",t.GAME_OVER="gameOver",t.LASER="laser",t.MAIN_THEME="shockWave",t.EXPLOSION_I="explosion1",t.EXPLOSION_II="explosion2",t.BOX="box",t.ARENA="arena"}(e.EntityType||(e.EntityType={}))},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(23);!function(t){t.UP="UP",t.DOWN="DOWN",t.LEFT="LEFT",t.RIGHT="RIGHT",t.SHOOT="SHOOT",t.RESTART="RESTART",t.ROTATE_LEFT="R-LEFT",t.ROTATE_RIGHT="R-RIGHT"}(e.Actions||(e.Actions={}));e.default=class extends s.default{constructor(t){super(),this.inputMap=t.keyBoard,this.init(),this.initializeTouchHandler(),this.touches={start:[],move:[]}}init(){window.addEventListener("keydown",t=>{let e=" "!==t.key?t.key:"space";this.state[this.inputMap[e]]=!0,this.notify()}),window.addEventListener("keyup",t=>{let e=" "!==t.key?t.key:"space";this.state[this.inputMap[e]]=!1,this.notify()})}initializeTouchHandler(){let t=document.getElementById("move"),e=t||window;e.addEventListener("touchstart",function(t){t.preventDefault(),i=t.touches,n=t.touches[0].pageX,a=t.touches[0].pageY},!1),e.addEventListener("touchmove",function(t){r.reset(),t.preventDefault(),s=t.changedTouches,o=t.touches[0].pageX,h=t.touches[0].pageY;for(let e=0;e<t.touches.length;e++)s[e].pageX<i[e].pageX&&(r.state[r.inputMap.a]=!0),s[e].pageX>i[e].pageX&&(r.state[r.inputMap.d]=!0),s[e].pageY<i[e].pageY&&(r.state[r.inputMap.w]=!0),s[e].pageY>i[e].pageY&&(r.state[r.inputMap.s]=!0),r.notify()},!1),e.addEventListener("touchend",function(t){t.preventDefault(),r.reset()},!1),e.addEventListener("contextmenu",t=>(t.preventDefault(),!1));let i=[],s=[],n=0,a=0,o=0,h=0,r=this}shoot(){this.state[this.inputMap.space]=!0}cancelShoot(){this.state[this.inputMap.space]=!1}reset(){this.state[this.inputMap.w]=!1,this.state[this.inputMap.a]=!1,this.state[this.inputMap.s]=!1,this.state[this.inputMap.d]=!1}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class s{constructor(t,e){this.x=t,this.y=e}static addVector(t,e){return new s(t.x+e.x,t.y+e.y)}static subtractVector(t,e){return new s(t.x-e.x,t.y-e.y)}static multiply(t,e){return new s(t.x*e,t.y*e)}static divide(t,e){if(0===e)throw new Error('cannot divide vector by scalar with value "0"');return new s(t.x/e,t.y/e)}set x(t){this._x=t}set y(t){this._y=t}get x(){return this._x}get y(){return this._y}set(t,e){this.x=t,this.y=e}setVector(t){this.x=t.x,this.y=t.y}add(t,e){this.x+=t,this.y+=e}addVector(t){this.x+=t.x,this.y+=t.y}subtract(t,e){this.x-=t,this.y-=e}subtractVector(t){this.x-=t.x,this.y-=t.y}multiply(t){this.x*=t,this.y*=t}divide(t){if(0===t)throw new Error('cannot divide vector by "0"');this.x/=t,this.y/=t}mag(){return Math.sqrt(this.x*this.x+this.y*this.y)}negative(){return new s(-this.x,-this.y)}normalize(){let t=this.mag();0!==t&&this.divide(t)}limit(t){Math.floor(this.mag())>t&&(this.normalize(),this.multiply(t))}distanceTo(t){return Math.sqrt(Math.pow(t.x-this.x,2)+Math.pow(t.y-this.y,2))}dot(t){return this.x*t.x+this.y*t.y}floor(){this.x=Math.floor(this.x),this.x=Math.floor(this.x)}clone(){return new s(this.x,this.y)}}e.default=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.PLAYER="ship",t.ENEMY="enemy",t.ENEMY_BULLET="bulletEnemy",t.PLAYER_BULLET="bullet",t.BACKGROUND="background",t.MAP="map",t.GAME_OVER="gameOver",t.LASER="laser",t.MAIN_THEME="shockWave",t.EXPLOSION_I="explosion1",t.EXPLOSION_II="explosion2",t.BOX="box",t.ARENA="arena"}(e.AssetId||(e.AssetId={}))},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(27),n=i(26);var a;!function(t){t.SPRITE="SPRITE",t.SPRITE_SHEET="SPRITE_SHEET",t.AUDIO="AUDIO",t.AUDIO_AMB="LOOP"}(a=e.AssetType||(e.AssetType={}));e.default=class{constructor(t){this.cache={sprites:{},spriteSheets:{},audio:{}},this.downloadCount=0,this.queue=[],this.audioManager=t}done(){return this.downloadCount===this.queue.length}queueDownload(t,e,i,s=null){this.queue.push({id:t,path:e,type:i,opts:s})}loadAudio(t,e){n.default.create({method:"GET",url:t.path,responseType:"arraybuffer"},i=>{this.audioManager.decodeAudio(i,t.id,i=>{this.cache.audio[t.id]=i,this.downloadCount+=1,this.done()&&e()})})}loadSprite(t,e){let i=new Image;i.addEventListener("load",()=>{this.downloadCount++,this.done()&&e()}),i.src=t.path,this.cache.sprites[t.id]=i}loadSpriteSheet(t,e){let i=new Image;i.addEventListener("load",()=>{this.cache.spriteSheets[t.id]=new s.default(i,t.opts.frameWidth||0,t.opts.frameHeight||0),this.downloadCount+=1,this.done()&&e()}),i.src=t.path}downloadAll(t){this.queue.forEach(e=>{e.type===a.AUDIO?this.loadAudio(e,t):e.type===a.SPRITE?this.loadSprite(e,t):e.type===a.SPRITE_SHEET&&this.loadSpriteSheet(e,t)})}getSound(t,e){let i=e===a.AUDIO_AMB;return this.audioManager.createSound(this.cache.audio[t],i)}getSprite(t){return this.cache.sprites[t]}getSpriteSheet(t){return this.cache.spriteSheets[t]}}},,,function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=class{static registerOnElement(t,e,i){e.forEach(e=>t.addEventListener(e,i))}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(2),n=i(0);e.default=class{constructor(t,e,i,a){this.position=new s.default(t,e),this.width=i,this.height=a,this.colliding=!1,this.collidesWith=[],this.type=n.EntityType.BOX,this.collidesWith.push(n.EntityType.PLAYER)}isCollideAbleWith(t){return this.collidesWith.includes(t.type.toString())}}},,,,function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=class{constructor(t){this.game=t,this.lastTime=null}start(){this.game.init(),this.game.state.running=!0,this.frameId=requestAnimationFrame(t=>this.loop(t))}stop(){this.game.state.running=!1,this.frameId&&cancelAnimationFrame(this.frameId)}restart(){this.stop(),this.start()}togglePause(){this.game.state.paused=!this.game.state.paused}loop(t){if(this.game.state.running&&!this.game.state.paused){if(null!==this.lastTime){const e=t-this.lastTime;this.game.update(e/1e3)}this.lastTime=t,this.game.render(),this.frameId=requestAnimationFrame(t=>this.loop(t))}}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=class{constructor(t,e,i){this.audioContext=t,this.masterGain=e,this.buffer=i,this.gainNode=this.audioContext.createGain(),this.gainNode.gain.value=.2,this.gainNode.connect(this.masterGain),this.playing=!1}play(t=!1){this.source=this.audioContext.createBufferSource(),this.source.buffer=this.buffer,this.source.loop=t,this.source.connect(this.gainNode),this.source.start(0)}stop(){this.source.stop(0)}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(13);e.default=class{constructor(){this.initAudioContext()}initAudioContext(){try{window.AudioContext=window.AudioContext||webkitAudioContext,this.audioContext=new AudioContext,this.masterGain=this.audioContext.createGain(),this.effectsGain=this.audioContext.createGain(),this.ambientGain=this.audioContext.createGain(),this.masterGain.gain.value=1,this.masterGain.connect(this.audioContext.destination),this.effectsGain.connect(this.masterGain),this.ambientGain.connect(this.masterGain),this.ambientGain.gain.value=1,this.effectsGain.gain.value=1}catch(t){console.log("Web Audio API is not supported in this browser")}}decodeAudio(t,e,i){this.audioContext.decodeAudioData(t).then(t=>i(t),t=>{console.log("Error with decoding audio data"+t)})}adjustMasterVolume(t){this.masterGain.gain.value=t}adjustAmbientVolume(t){this.ambientGain.gain.value=t}adjustEffectsVolume(t){this.effectsGain.gain.value=t}createSound(t,e){return new s.default(this.audioContext,e?this.ambientGain:this.effectsGain,t)}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(1),n=i(7);e.default=class{constructor(t,e,i,s){this.element=t,this.settings=e,this.assetManager=i,this.audioManager=s,this.showing=!1}createMainMenu(){this.mainMenu=document.createElement("div"),this.mainMenu.classList.add("tab"),this.element.appendChild(this.mainMenu)}openTab(t,e){let i,s;i=document.getElementsByClassName("tabContent");for(let t=0;t<i.length;t++)i[t].style.display="none";s=document.getElementsByClassName("tabLink");for(let t=0;t<s.length;t++)s[t].className=s[t].className.replace(" active","");document.getElementById(e).style.display="block",t.currentTarget.className+=" active"}createKeyboardMenu(){let t=document.createElement("button"),e=document.createElement("div"),i=document.createElement("h4"),a=document.createElement("form"),o=document.createElement("input");n.default.registerOnElement(t,["click","touchstart"],t=>this.openTab(t,"keyboardMenu")),t.appendChild(document.createTextNode("Keyboard")),t.classList.add("tabLink"),this.mainMenu.appendChild(t),e.setAttribute("id","keyboardMenu"),e.classList.add("tabContent"),i.appendChild(document.createTextNode("Keyboard")),a.setAttribute("id","keyboardSettings"),a.setAttribute("method","post"),o.setAttribute("type","submit"),o.setAttribute("value","Save"),e.appendChild(i),e.appendChild(a),this.element.appendChild(e),Object.keys(this.settings.keyBoard).forEach(t=>this.addEntry(t,a)),a.appendChild(o),a.addEventListener("submit",t=>{t.preventDefault(),this.settings.setKey(document.getElementById(s.Actions.UP).value,s.Actions.UP),this.settings.setKey(document.getElementById(s.Actions.DOWN).value,s.Actions.DOWN),this.settings.setKey(document.getElementById(s.Actions.LEFT).value,s.Actions.LEFT),this.settings.setKey(document.getElementById(s.Actions.RIGHT).value,s.Actions.RIGHT),this.settings.setKey(document.getElementById(s.Actions.SHOOT).value,s.Actions.SHOOT),this.settings.setKey(document.getElementById(s.Actions.RESTART).value,s.Actions.RESTART),this.clear()})}createPlayerMenu(){let t=document.createElement("button"),e=document.createElement("div"),i=document.createElement("h4"),s=document.createElement("form"),a=document.createElement("input");n.default.registerOnElement(t,["click","touchstart"],t=>this.openTab(t,"playerMenu")),t.appendChild(document.createTextNode("Player")),t.classList.add("tabLink"),this.mainMenu.appendChild(t),e.setAttribute("id","playerMenu"),e.classList.add("tabContent"),i.appendChild(document.createTextNode("Player Settings")),s.setAttribute("id","playerSettings"),s.setAttribute("method","post"),a.setAttribute("type","submit"),a.setAttribute("value","Save"),e.appendChild(i),e.appendChild(s),this.element.appendChild(e),Object.keys(this.settings.player).forEach(t=>this.addPlayerSettingEntry(t,s)),s.appendChild(a),s.addEventListener("submit",t=>{t.preventDefault(),this.settings.player.acceleration=Number(document.getElementById("acceleration").value),this.settings.player.maxVelocity=Number(document.getElementById("maxVelocity").value),this.settings.player.friction=Number(document.getElementById("friction").value),this.settings.player.fireDelay=Number(document.getElementById("fireDelay").value),this.clear()})}createAudioMenu(){let t=document.createElement("button"),e=document.createElement("div"),i=document.createElement("div"),s=document.createElement("h4"),a=document.createElement("label"),o=document.createElement("input");n.default.registerOnElement(t,["click","touchstart"],t=>this.openTab(t,"audioMenu")),t.classList.add("tabLink"),t.appendChild(document.createTextNode("Audio")),this.mainMenu.appendChild(t),e.setAttribute("id","audioMenu"),e.classList.add("tabContent"),i.classList.add("row"),s.appendChild(document.createTextNode("Audio Settings")),a.appendChild(document.createTextNode("Master Volume:")),a.setAttribute("for","masterVolume"),o.setAttribute("id","masterVolume"),o.setAttribute("type","range"),o.setAttribute("min","0"),o.setAttribute("max","1"),o.setAttribute("step","0.1"),o.addEventListener("change",t=>this.audioManager.adjustMasterVolume(Number(o.value))),i.appendChild(s),i.appendChild(a),i.appendChild(o),e.appendChild(i);let h=document.createElement("div"),r=document.createElement("label"),d=document.createElement("input");h.classList.add("row"),r.appendChild(document.createTextNode("Ambient Volume:")),r.setAttribute("for","ambientVolume"),d.setAttribute("id","ambientVolume"),d.setAttribute("type","range"),d.setAttribute("min","0"),d.setAttribute("max","1"),d.setAttribute("step","0.1"),d.addEventListener("change",t=>this.audioManager.adjustAmbientVolume(Number(d.value))),h.appendChild(r),h.appendChild(d),e.appendChild(h);let l=document.createElement("div"),c=document.createElement("label"),u=document.createElement("input");l.classList.add("row"),c.appendChild(document.createTextNode("Effects Volume:")),c.setAttribute("for","effectsVolume"),u.setAttribute("id","effectsVolume"),u.setAttribute("type","range"),u.setAttribute("min","0"),u.setAttribute("max","1"),u.setAttribute("step","0.1"),u.addEventListener("change",t=>this.audioManager.adjustEffectsVolume(Number(u.value))),l.appendChild(c),l.appendChild(u),e.appendChild(l),this.element.appendChild(e)}init(){this.createMainMenu(),this.createKeyboardMenu(),this.createPlayerMenu(),this.createAudioMenu()}clear(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.init()}addPlayerSettingEntry(t,e){let i=document.createElement("label"),s=document.createElement("input"),n=document.createElement("div");i.setAttribute("for",t),i.appendChild(document.createTextNode(t+":")),s.setAttribute("id",t),s.setAttribute("type","number"),s.setAttribute("name",t),s.setAttribute("value",this.settings.player[t]),n.classList.add("row"),n.appendChild(i),n.appendChild(s),e.appendChild(n)}addEntry(t,e){let i=document.createElement("div"),s=document.createElement("label"),n=document.createElement("input");i.classList.add("row"),s.setAttribute("for",this.settings.keyBoard[t]),s.appendChild(document.createTextNode(this.settings.keyBoard[t]+":")),n.setAttribute("id",this.settings.keyBoard[t]),n.setAttribute("type","text"),n.setAttribute("name",this.settings.keyBoard[t]),n.setAttribute("value",t),i.appendChild(s),i.appendChild(n),e.appendChild(i)}toggleShow(){this.showing?(this.element.style.display="none",this.showing=!1):(this.element.style.display="block",this.showing=!0)}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(1);e.default=class{constructor(){this.keyBoard={w:s.Actions.UP,s:s.Actions.DOWN,a:s.Actions.LEFT,d:s.Actions.RIGHT,space:s.Actions.SHOOT,r:s.Actions.RESTART,q:s.Actions.ROTATE_LEFT,e:s.Actions.ROTATE_RIGHT},this.player={maxVelocity:15,fireDelay:15,friction:.7,acceleration:3},this.audio={master:1,ambient:1,effects:1}}findKey(t){return Object.keys(this.keyBoard).filter(e=>this.keyBoard[e]===t)[0]}setKey(t,e){let i=this.findKey(e);t!==i&&(console.log("old:"+i," new: "+t+" value: "+e),this.keyBoard[t]=this.keyBoard[i],delete this.keyBoard[i])}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=class{constructor(t){this.quadTree=t}detectCollision(){let t=[];this.quadTree.getAllObjects(t);for(let e=0;e<t.length;e++){let i=[];this.quadTree.findObjects(i,t[e]);for(let s=0;s<i.length;s++)t[e].isCollideAbleWith(i[s])&&Math.floor(t[e].position.x)<Math.floor(i[s].position.x)+i[s].width&&Math.floor(t[e].position.x)+t[e].width>Math.floor(i[s].position.x)&&Math.floor(t[e].position.y)<Math.floor(i[s].position.y)+i[s].height&&Math.floor(t[e].position.y)+t[e].height>Math.floor(i[s].position.y)&&(t[e].colliding=!0,i[s].colliding=!0)}}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(8);class n{constructor(t=new s.default(0,0,0,0),e=0){this.level=e,this.maxObjects=10,this.maxLevels=5,this.hitBox=t,this.objects=[],this.nodes=[]}clear(){this.objects=[],this.nodes.forEach(t=>t.clear()),this.nodes=[]}getAllObjects(t){return this.nodes.forEach(e=>e.getAllObjects(t)),this.objects.forEach(e=>t.push(e)),t}findObjects(t,e){if(void 0===e)return void console.log("UNDEFINED OBJECT");let i=this.getIndex(e);return-1!==i&&this.nodes.length&&this.nodes[i].findObjects(t,e),this.objects.forEach(e=>t.push(e)),t}insert(t){if(void 0!==t)if(t instanceof Array)t.forEach(t=>this.insert(t));else{if(this.nodes.length>0){let e=this.getIndex(t);if(-1!==e)return void this.nodes[e].insert(t)}if(this.objects.push(t),this.objects.length>this.maxObjects&&this.level<this.maxLevels){void 0===this.nodes[0]&&this.split();let t=0;for(;t<this.objects.length;){let e=this.getIndex(this.objects[t]);-1!==e?this.nodes[e].insert(this.objects.splice(t,1)[0]):t++}}}}getIndex(t){let e=-1,i=this.hitBox.position.x+this.hitBox.width/2,s=this.hitBox.position.y+this.hitBox.height/2,n=t.position.y<s&&t.position.y+t.height<s,a=t.position.y>s;return t.position.x<i&&t.position.x+t.width<i?n?e=1:a&&(e=2):t.position.x>i&&(n?e=0:a&&(e=3)),e}split(){let t=this.hitBox.width/2|0,e=this.hitBox.height/2|0;this.nodes[0]=new n(new s.default(this.hitBox.position.x+t,this.hitBox.position.y,t,e),this.level+1),this.nodes[1]=new n(new s.default(this.hitBox.position.x,this.hitBox.position.y,t,e),this.level+1),this.nodes[2]=new n(new s.default(this.hitBox.position.x,this.hitBox.position.y+e,t,e),this.level+1),this.nodes[3]=new n(new s.default(this.hitBox.position.x+t,this.hitBox.position.y+e,t,e),this.level+1)}}e.default=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(2),n=i(0),a=i(4),o=i(3);e.default=class{constructor(t,e,i,h,r,d,l,c,u,p,g,m){this.position=new s.default(t,e),this.width=i,this.height=h,this.canvasWidth=r,this.canvasHeight=d,this.speed=l,this.context=c,this.sprite=u,this.percentFire=.001,this.chance=0,this.alive=!1,this.type=p,this.collidesWith=[],this.collidesWith.push(n.EntityType.PLAYER_BULLET),this.colliding=!1,this.bulletPool=g,this.game=m,this.explosionSound=this.game.assetManager.getSound(o.AssetId.EXPLOSION_I,a.AssetType.AUDIO)}spawn(t,e,i){this.position.x=t,this.position.y=e,this.speed=i,this.speedX=0,this.speedY=i,this.alive=!0,this.leftEdge=this.position.x-180,this.rightEdge=this.position.x+180,this.bottomEdge=this.position.y+280}draw(){return this.context.clearRect(this.position.x-1,this.position.y,this.width+1,this.height),this.position.x+=this.speedX,this.position.y+=this.speedY,this.position.x<=this.leftEdge?this.speedX=this.speed:this.position.x>=this.rightEdge+this.width?this.speedX=-this.speed:this.position.y>=this.bottomEdge&&(this.speed=1.5,this.speedY=0,this.position.y-=5,this.speedX=-this.speed),this.colliding?(this.game.scorePoints(),this.explosionSound.play(),!0):(this.context.drawImage(this.sprite,this.position.x,this.position.y),this.chance=Math.floor(101*Math.random()),this.chance/100<this.percentFire&&this.fire(),!1)}fire(){this.bulletPool.get(Math.floor(this.position.x+this.width/2),Math.floor(this.position.y+this.height),-5)}clear(){this.position.x=0,this.position.y=0,this.speed=0,this.speedX=0,this.speedY=0,this.alive=!1,this.colliding=!1}isCollideAbleWith(t){return this.collidesWith.includes(t.type.toString())}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(2),n=i(0);e.default=class{constructor(t,e,i,a,o,h,r,d,l,c){this.position=new s.default(t,e),this.speed=r,this.width=i,this.height=a,this.canvasWidth=o,this.canvasHeight=h,this.context=d,this.sprite=l,this.alive=!1,this.type=c,this.colliding=!1,this.collidesWith=[],this.type===n.EntityType.PLAYER_BULLET?this.collidesWith.push(n.EntityType.ENEMY):this.type===n.EntityType.ENEMY_BULLET&&this.collidesWith.push(n.EntityType.PLAYER)}spawn(t,e,i){this.position.set(t,e),this.speed=i,this.alive=!0}draw(){return this.context.clearRect(this.position.x-1,this.position.y-1,this.width+1,this.height+1),this.position.y-=this.speed,!!this.colliding||this.type===n.EntityType.PLAYER_BULLET&&this.position.y<=0-this.height||this.type===n.EntityType.ENEMY_BULLET&&this.position.y>=this.canvasHeight||(this.context.drawImage(this.sprite,this.position.x,this.position.y),!1)}clear(){this.position.set(0,0),this.speed=0,this.alive=!1,this.colliding=!1}isCollideAbleWith(t){return this.collidesWith.includes(t.type.toString())}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(20),n=i(19),a=i(0);e.default=class{constructor(t,e,i,s,n,a,o,h=null,r=null){this.assetManager=t,this.context=e,this.canvasWidth=i,this.canvasHeight=s,this.maxSize=n,this.type=a,this.assetId=o,this.pool=[],this.subPool=h,this.game=r,this.init()}init(){if(this.type===a.EntityType.ENEMY){let t=this.assetManager.getSprite(this.assetId);for(let e=0;e<this.maxSize;e++)this.pool[e]=new n.default(0,0,t.width,t.height,this.canvasWidth,this.canvasHeight,0,this.context,t,this.type,this.subPool,this.game)}else for(let t=0;t<this.maxSize;t++){let e=this.assetManager.getSprite(this.assetId);this.pool[t]=new s.default(0,0,e.width,e.height,this.canvasWidth,this.canvasHeight,0,this.context,e,this.type)}}get(t,e,i){let s=this.pool[this.maxSize-1];s.alive||(s.spawn(t,e,i),this.pool.unshift(this.pool.pop()))}getTwo(t,e,i,s,n,a){this.pool[this.maxSize-1].alive||this.pool[this.maxSize-2].alive||(this.get(t,e,i),this.get(s,n,a))}render(){for(let t=0;t<this.pool.length&&this.pool[t].alive;t++)this.pool[t].draw()&&(this.pool[t].clear(),this.pool.push(this.pool.splice(t,1)[0]))}clearAll(){this.pool.forEach(t=>t.clear())}getPool(){let t=[];return this.pool.forEach(e=>{e.alive&&t.push(e)}),t}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(2),n=i(0),a=i(1),o=i(4),h=i(3);e.default=class{constructor(t,e,i,a,r,d,l,c,u,p){this.position=new s.default(t,e),this.startPosition=new s.default(t,e),this.acceleration=new s.default(0,0),this.velocity=new s.default(0,0),this.width=i,this.height=a,this.canvasWidth=r,this.canvasHeight=d,this.context=l,this.sprite=c.getSprite(h.AssetId.PLAYER),this.type=n.EntityType.PLAYER,this.pool=u,this.counter=0,this.collidesWith=[],this.collidesWith.push(n.EntityType.ENEMY_BULLET),this.colliding=!1,this.state={},this.settings=p,this.maxTop=Math.floor(this.canvasHeight/4*3),this.laserSound=c.getSound(h.AssetId.LASER,o.AssetType.AUDIO)}reset(){this.position.setVector(this.startPosition),this.velocity.set(0,0),this.colliding=!1}move(){this.colliding||(this.counter++,this.context.clearRect(Math.floor(this.position.x),Math.floor(this.position.y),this.width,this.height),this.acceleration.set(0,0),this.state[a.Actions.LEFT]&&this.acceleration.add(-this.settings.acceleration,0),this.state[a.Actions.RIGHT]&&this.acceleration.add(this.settings.acceleration,0),this.state[a.Actions.UP]&&this.acceleration.add(0,-this.settings.acceleration),this.state[a.Actions.DOWN]&&this.acceleration.add(0,this.settings.acceleration),this.velocity.multiply(this.settings.friction),this.velocity.addVector(this.acceleration),this.velocity.limit(this.settings.maxVelocity),this.position.addVector(this.velocity),this.position.x<=0&&(this.position.x=0,this.velocity.x+=-1),this.position.x>=this.canvasWidth-this.width&&(this.position.x=this.canvasWidth-this.width),this.position.y<=this.maxTop&&(this.position.y=this.maxTop),this.position.y>=this.canvasHeight-this.height&&(this.position.y=this.canvasHeight-this.height),this.draw(),this.state[a.Actions.SHOOT]&&this.counter>=this.settings.fireDelay&&!this.colliding&&(this.fire(),this.counter=0))}alive(){return!this.colliding}draw(){this.context.drawImage(this.sprite,Math.floor(this.position.x),Math.floor(this.position.y))}update(t){this.state=t}fire(){this.pool.getTwo(Math.floor(this.position.x)+12,Math.floor(this.position.y),6,Math.floor(this.position.x)+66,Math.floor(this.position.y),6),this.laserSound.play()}isCollideAbleWith(t){return this.collidesWith.includes(t.type.toString())}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=class{constructor(){this._observers=[],this._state={}}register(t){this._observers.push(t)}unRegister(t){this._observers=this._observers.filter(e=>e!==t)}notify(){this._observers.forEach(t=>{t.update(this._state)})}get observers(){return this._observers}set observers(t){this._observers=t}get state(){return this._state}set state(t){this._state=t}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(2),n=i(0);e.default=class{constructor(t,e,i,a,o,h){this.position=new s.default(t,e),this.speed=1,this.width=i,this.height=a,this.canvasWidth=i,this.canvasHeight=a,this.context=o,this.sprite=h,this.type=n.EntityType.BACKGROUND}reset(){this.position.set(0,0)}draw(){this.position.y+=this.speed,this.context.drawImage(this.sprite,this.position.x,this.position.y),this.context.drawImage(this.sprite,this.position.x,this.position.y-this.height),this.position.y>=this.height&&(this.position.y=0)}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(24),n=i(4),a=i(1),o=i(22),h=i(21),r=i(18),d=i(8),l=i(0),c=i(17),u=i(3);e.default=class{constructor(t,e,i,s){this.playing=!1,this.paused=!1,this.window=window,this.assetManager=t,this.inputManager=e,this.settings=i,this.canvases=s,this.init()}init(){this.canvases.background.getContext&&(this.backgroundContext=this.canvases.background.getContext("2d"),this.shipContext=this.canvases.ship.getContext("2d"),this.mainContext=this.canvases.main.getContext("2d"),this.playerScore=0,this.background=new s.default(0,0,this.canvases.background.width,this.canvases.background.height,this.backgroundContext,this.assetManager.getSprite(u.AssetId.BACKGROUND)),this.shipStartX=this.canvases.ship.width/2-this.assetManager.getSprite(u.AssetId.PLAYER).width,this.shipStartY=this.canvases.ship.height/4*3+2*this.assetManager.getSprite(u.AssetId.PLAYER).height,this.ship=new o.default(this.shipStartX,this.shipStartY,this.assetManager.getSprite(u.AssetId.PLAYER).width,this.assetManager.getSprite(u.AssetId.PLAYER).height,this.canvases.ship.width,this.canvases.ship.height,this.shipContext,this.assetManager,new h.default(this.assetManager,this.mainContext,this.canvases.main.width,this.canvases.main.height,80,l.EntityType.PLAYER_BULLET,u.AssetId.PLAYER_BULLET),this.settings.player),this.enemyBulletPool=new h.default(this.assetManager,this.mainContext,this.canvases.main.width,this.canvases.main.height,50,l.EntityType.ENEMY_BULLET,u.AssetId.ENEMY_BULLET),this.enemyPool=new h.default(this.assetManager,this.mainContext,this.canvases.main.width,this.canvases.main.height,30,l.EntityType.ENEMY,u.AssetId.ENEMY,this.enemyBulletPool,this),this.spawnWave(),this.inputManager.register(this.ship),this.inputManager.register(this),this.quadTree=new r.default(new d.default(0,0,this.canvases.main.width,this.canvases.main.height)),this.collisionManager=new c.default(this.quadTree),this.backgroundAudio=this.assetManager.getSound(u.AssetId.MAIN_THEME,n.AssetType.AUDIO_AMB),this.backgroundAudio.play(!0),this.start())}togglePause(){this.paused=!this.paused}spawnWave(){const t=this.assetManager.getSprite(u.AssetId.ENEMY).height,e=this.assetManager.getSprite(u.AssetId.ENEMY).width;let i=200,s=-t;const n=1.5*s;for(let t=1;t<=21;t++)this.enemyPool.get(i,s,4),i+=e+25,t%7==0&&(i=200,s+=n)}render(){this.playing&&(this.paused||(document.getElementById("score").innerHTML=this.playerScore.toString(),this.quadTree.clear(),this.quadTree.insert(this.ship),this.quadTree.insert(this.ship.pool.getPool()),this.quadTree.insert(this.enemyPool.getPool()),this.quadTree.insert(this.enemyBulletPool.getPool()),this.collisionManager.detectCollision(),0===this.enemyPool.getPool().length&&this.spawnWave(),this.ship.alive()?(this.background.draw(),this.ship.move(),this.ship.pool.render(),this.enemyPool.render(),this.enemyBulletPool.render()):(this.playing=!1,this.gameOver())),this.animReqID=window.requestAnimationFrame(()=>this.render()))}scorePoints(){this.playerScore+=10}update(t){t[a.Actions.RESTART]&&this.restart()}start(){this.playing=!0,this.render(),this.ship.draw()}gameOver(){this.backgroundAudio.stop(),document.getElementById("game-over").style.display="block",this.gameOverAudio=this.assetManager.getSound(u.AssetId.GAME_OVER,n.AssetType.AUDIO_AMB),this.gameOverAudio.play(!0)}restart(){this.playing?(window.cancelAnimationFrame(this.animReqID),this.playing=!1,this.backgroundAudio.stop(),this.backgroundAudio.play(!0)):(this.gameOverAudio.stop(),this.backgroundAudio.play(!0),document.getElementById("game-over").style.display="none"),this.backgroundContext.clearRect(0,0,this.canvases.background.width,this.canvases.background.height),this.shipContext.clearRect(0,0,this.canvases.ship.width,this.canvases.ship.height),this.mainContext.clearRect(0,0,this.canvases.main.width,this.canvases.main.height),this.quadTree.clear(),this.background.reset(),this.playerScore=0,this.ship.reset(),this.enemyBulletPool.clearAll(),this.enemyPool.clearAll(),this.ship.pool.clearAll(),this.start()}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class s{static create(t,e){let i=new XMLHttpRequest;i.addEventListener("load",()=>{e(i.response)}),i.open(t.method?t.method:s.defaults.method,t.url?t.url:s.defaults.url,t.async?t.async:s.defaults.async),t.hasOwnProperty("contentType")&&i.setRequestHeader("Content-Type",t.contentType?t.contentType:s.defaults.contentType),t.hasOwnProperty("responseType")&&(i.responseType=t.responseType),t.hasOwnProperty("data")&&"object"==typeof t.data&&(t.data=JSON.stringify(t.data)),i.send(t.data?t.data:null)}}s.defaults={url:"",method:"GET",contentType:"text/html",async:!0,data:null},e.default=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=class{constructor(t,e,i){this._image=t,this._frameWidth=e,this._frameHeight=i,this._framesPerRow=Math.floor(this._image.width/this._frameWidth)}get image(){return this._image}set image(t){if(!(t instanceof Image))throw new Error("Param tileSetImage must be of type Image!");this._image=t}get frameWidth(){return this._frameWidth}set frameWidth(t){this._frameWidth=t}get frameHeight(){return this._frameHeight}set frameHeight(t){this._frameHeight=t}get framesPerRow(){return this._framesPerRow}set framesPerRow(t){this._framesPerRow=t}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(4),n=i(25),a=i(1),o=i(16),h=i(15),r=i(7),d=i(3),l=i(14),c=i(12),u=new l.default,p=new s.default(u),g={background:document.getElementById("background"),ship:document.getElementById("ship"),main:document.getElementById("main")},m=new o.default,y=new a.default(m),f=new h.default(document.getElementById("settings-menu"),m,p,u);p.queueDownload(d.AssetId.BACKGROUND,"assets/textures/background.png",s.AssetType.SPRITE),p.queueDownload(d.AssetId.PLAYER,"assets/sprites/ship.png",s.AssetType.SPRITE),p.queueDownload(d.AssetId.PLAYER_BULLET,"assets/sprites/bullet.png",s.AssetType.SPRITE),p.queueDownload(d.AssetId.ENEMY,"assets/sprites/enemy.png",s.AssetType.SPRITE),p.queueDownload(d.AssetId.ENEMY_BULLET,"assets/sprites/bullet_enemy.png",s.AssetType.SPRITE),p.queueDownload(d.AssetId.MAIN_THEME,"assets/audio/kick_shock.wav",s.AssetType.AUDIO),p.queueDownload(d.AssetId.LASER,"assets/audio/laser.wav",s.AssetType.AUDIO),p.queueDownload(d.AssetId.EXPLOSION_I,"assets/audio/explosion.wav",s.AssetType.AUDIO),p.queueDownload(d.AssetId.GAME_OVER,"assets/audio/game_over.wav",s.AssetType.AUDIO),p.downloadAll(()=>{const t=new n.default(p,y,m,g);new c.default(t);f.init();let e=document.getElementById("game-over"),i=document.getElementById("settings"),s=document.getElementById("shoot"),a=["click","touchstart"];s.addEventListener("touchstart",()=>y.shoot()),s.addEventListener("touchend",()=>y.cancelShoot()),s.addEventListener("contextmenu",t=>(t.preventDefault(),!1)),r.default.registerOnElement(e,a,()=>t.restart()),r.default.registerOnElement(i,a,()=>{f.toggleShow(),t.togglePause()})})}]);
//# sourceMappingURL=multiverseInvaders.js.map