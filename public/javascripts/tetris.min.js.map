{"version":3,"sources":["webpack:///webpack/bootstrap 73076fdd0a47ce4f39d5","webpack:///./src/game/interfaces/CollideAble.ts","webpack:///./src/client/InputManager.ts","webpack:///./src/lib/math/Vector2.ts","webpack:///./src/lib/observer/Observable.ts","webpack:///./src/tetris/game.ts","webpack:///./src/tetris/Tetris.ts","webpack:///./src/tetris/Player.ts","webpack:///./src/tetris/Arena.ts","webpack:///./src/tetris/Piece.ts","webpack:///./src/lib/collision/MatrixCollisionManager.ts","webpack:///./src/client/Settings.ts","webpack:///./src/lib/math/Matrix.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","EntityType","Observable_1","Actions","default","[object Object]","settings","super","this","inputMap","keyBoard","init","initializeTouchHandler","touches","start","move","window","addEventListener","event","key","state","notify","button","document","getElementById","el","handleTouchStart","handleTouchMove","handleTouchEnd","preventDefault","touchstartX","touchstartY","toucheMoveX","touchMoveY","thisInstance","evt","pageX","pageY","reset","changedTouches","length","Vector2","x","y","v1","v2","vector","scalar","Error","_x","_y","Math","sqrt","magnitude","mag","divide","max","floor","normalize","multiply","pow","_observers","_state","observer","push","filter","obs","forEach","update","observers","Tetris_1","InputManager_1","Settings_1","Piece_1","inputManager","canvas","tetris","addPlayer","arena","matrix","mArray","register","players","Player_1","Arena_1","colors","context","getContext","playing","lastTime","scale","playerId","playerName","piece","run","offset","row","value","fillStyle","fillRect","timeStamp","deltaTime","render","requestAnimationFrame","animationCallback","bind","player","dropCounter","dropInterval","drop","width","height","drawMatrix","postition","position","id","score","LEFT","RIGHT","DOWN","ROTATE_LEFT","rotate","ROTATE_RIGHT","Matrix_1","Vector2_1","array","Array","fill","rowCount","outer","splice","unshift","CollideAble_1","MatrixCollisionManager_1","types","I","L","J","O","Z","S","T","setRandom","collidesWith","ARENA","colliding","add","direction","pos","detectCollision","merge","sweep","other","includes","type","toString","set","random","arenaMatrix","w","UP","a","space","SHOOT","r","RESTART","q","e","maxVelocity","fireDelay","friction","acceleration","audio","master","ambient","effects","keys","newKey","action","oldKey","findKey","console","log","Matrix","rows","columns","valid","equals","j","newArray","val","k","transpose","reverse","arr","slice","from"],"mappings":"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","file":"tetris.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 54);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 73076fdd0a47ce4f39d5","export enum EntityType {\r\n  PLAYER = 'ship',\r\n  ENEMY = 'enemy',\r\n  ENEMY_BULLET = 'bulletEnemy',\r\n  PLAYER_BULLET = 'bullet',\r\n  BACKGROUND = 'background',\r\n  MAP = 'map',\r\n  GAME_OVER = 'gameOver',\r\n  LASER = 'laser',\r\n  MAIN_THEME = 'shockWave',\r\n  EXPLOSION_I = 'explosion1',\r\n  EXPLOSION_II = 'explosion2',\r\n  BOX = 'box',\r\n  ARENA = 'arena'\r\n}\r\n\r\n/**\r\n * Interface for collide able objects.\r\n */\r\nexport default interface CollideAble {\r\n  type: EntityType\r\n  collidesWith\r\n  colliding: boolean\r\n\r\n  isCollideAbleWith (other: CollideAble): boolean\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/game/interfaces/CollideAble.ts","import Observable from '../lib/observer/Observable'\r\nimport Settings from './Settings'\r\n\r\nexport enum Actions {\r\n  UP = 'UP',\r\n  DOWN = 'DOWN',\r\n  LEFT = 'LEFT',\r\n  RIGHT = 'RIGHT',\r\n  SHOOT = 'SHOOT',\r\n  RESTART = 'RESTART',\r\n  ROTATE_LEFT = 'R-LEFT',\r\n  ROTATE_RIGHT = 'R-RIGHT'\r\n}\r\n\r\n/**\r\n * Input manager class.\r\n *\r\n * @author Daniel Peters\r\n * @version 1.0\r\n */\r\nexport default class InputManager extends Observable {\r\n  inputMap\r\n  touches\r\n\r\n  /**\r\n   *\r\n   */\r\n  constructor (settings: Settings) {\r\n    super()\r\n    this.inputMap = settings.keyBoard\r\n    this.init()\r\n    this.initializeTouchHandler()\r\n    this.touches = {\r\n      start: [],\r\n      move: []\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Register pressed keys and notify observers.\r\n   */\r\n  init (): void {\r\n    window.addEventListener('keydown', event => {\r\n      let key = event.key !== ' ' ? event.key : 'space'\r\n      this.state[this.inputMap[key]] = true\r\n      this.notify()\r\n    })\r\n    window.addEventListener('keyup', event => {\r\n      let key = event.key !== ' ' ? event.key : 'space'\r\n      this.state[this.inputMap[key]] = false\r\n      this.notify()\r\n    })\r\n  }\r\n\r\n  /**\r\n   * Maps swipe directions to key press booleans.\r\n   * Allows touch controls on mobile.\r\n   */\r\n  initializeTouchHandler (): void {\r\n    // Register the event listeners\r\n    let button = document.getElementById('move')\r\n    let el = button ? button : window\r\n    el.addEventListener('touchstart', handleTouchStart, false)\r\n    el.addEventListener('touchmove', handleTouchMove, false)\r\n    el.addEventListener('touchend', handleTouchEnd, false)\r\n    el.addEventListener('contextmenu', event => {\r\n      event.preventDefault()\r\n      return false\r\n    })\r\n\r\n    let start = []\r\n    let move = []\r\n    let touchstartX = 0\r\n    let touchstartY = 0\r\n    let toucheMoveX = 0\r\n    let touchMoveY = 0\r\n    let thisInstance = this\r\n\r\n    function handleTouchStart (evt): void {\r\n      evt.preventDefault()\r\n      start = evt.touches\r\n      touchstartX = evt.touches[0].pageX\r\n      touchstartY = evt.touches[0].pageY\r\n    }\r\n\r\n    function handleTouchMove (evt): void {\r\n      thisInstance.reset()\r\n      evt.preventDefault()\r\n      move = evt.changedTouches\r\n      toucheMoveX = evt.touches[0].pageX\r\n      touchMoveY = evt.touches[0].pageY\r\n      for (let i = 0; i < evt.touches.length; i++) {\r\n        // Positive values equals left. Negative values equals right\r\n        if (move[i].pageX < start[i].pageX) {\r\n          thisInstance.state[thisInstance.inputMap['a']] = true\r\n        }\r\n        if (move[i].pageX > start[i].pageX) {\r\n          thisInstance.state[thisInstance.inputMap['d']] = true\r\n        }\r\n        if (move[i].pageY < start[i].pageY) {\r\n          thisInstance.state[thisInstance.inputMap['w']] = true\r\n        }\r\n        if (move[i].pageY > start[i].pageY) {\r\n          thisInstance.state[thisInstance.inputMap['s']] = true\r\n        }\r\n        thisInstance.notify()\r\n      }\r\n    }\r\n\r\n    function handleTouchEnd (evt): void {\r\n      evt.preventDefault()\r\n      thisInstance.reset()\r\n    }\r\n  }\r\n\r\n  shoot (): void {\r\n    this.state[this.inputMap['space']] = true\r\n  }\r\n\r\n  cancelShoot (): void {\r\n    this.state[this.inputMap['space']] = false\r\n  }\r\n\r\n  reset (): void {\r\n    this.state[this.inputMap['w']] = false\r\n    this.state[this.inputMap['a']] = false\r\n    this.state[this.inputMap['s']] = false\r\n    this.state[this.inputMap['d']] = false\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/client/InputManager.ts","/**\r\n * 2D vector implementation.\r\n *\r\n * @author Daniel Peters\r\n * @version 1.0\r\n */\r\nexport default class Vector2 {\r\n  private _x: number\r\n  private _y: number\r\n\r\n  /**\r\n   * Default constructor. Sets x and y values.\r\n   *\r\n   * @param {number} x initial x value\r\n   * @param {number} y initial y value\r\n   */\r\n  constructor (x: number, y: number) {\r\n    this.x = x\r\n    this.y = y\r\n  }\r\n\r\n  /**\r\n   * Static addVector method to combine two vectors into a new one.\r\n   *\r\n   * @param {Vector2} v1 first vector\r\n   * @param {Vector2} v2 second vector\r\n   * @returns {Vector2} combined vector\r\n   */\r\n  static addVector (v1: Vector2, v2: Vector2): Vector2 {\r\n    return new Vector2(v1.x + v2.x, v1.y + v2.y)\r\n  }\r\n\r\n  /**\r\n   * Subtract two vector from each other and put the result into a new vector.\r\n   *\r\n   * @param {Vector2} v1 first vector\r\n   * @param {Vector2} v2 second vector\r\n   * @returns {Vector2} resulting vector\r\n   */\r\n  static subtractVector (v1: Vector2, v2: Vector2): Vector2 {\r\n    return new Vector2(v1.x - v2.x, v1.y - v2.y)\r\n  }\r\n\r\n  /**\r\n   * Multiplies a vector with a scalar and returns the resulting vector.\r\n   *\r\n   * @param {Vector2} vector initial vector\r\n   * @param {number} scalar scalar to scale the vector\r\n   * @returns {Vector2} the resulting vector\r\n   */\r\n  static multiply (vector: Vector2, scalar: number): Vector2 {\r\n    return new Vector2(vector.x * scalar, vector.y * scalar)\r\n  }\r\n\r\n  /**\r\n   * Divides a vector by a scalar and returns the result in a new vector.\r\n   * Throws error if trying to divide by zero.\r\n   *\r\n   * @param {Vector2} vector vector to divide\r\n   * @param {number} scalar scalar used to divide vector\r\n   * @returns {Vector2} resulting vector\r\n   */\r\n  static divide (vector: Vector2, scalar: number): Vector2 {\r\n    if (scalar === 0) {\r\n      throw new Error('cannot divide vector by scalar with value \"0\"')\r\n    }\r\n    return new Vector2(vector.x / scalar, vector.y / scalar)\r\n  }\r\n\r\n  /**\r\n   * Set x value of this vector.\r\n   *\r\n   * @param {number} x new x value\r\n   */\r\n  set x (x: number) {\r\n    this._x = x\r\n  }\r\n\r\n  /**\r\n   * Set y value of this vector.\r\n   *\r\n   * @param {number} y new y value\r\n   */\r\n  set y (y: number) {\r\n    this._y = y\r\n  }\r\n\r\n  /**\r\n   * Getter for x value\r\n   * @returns {number} x value\r\n   */\r\n  get x (): number {\r\n    return this._x\r\n  }\r\n\r\n  /**\r\n   * Getter for y value\r\n   * @returns {number} y value\r\n   */\r\n  get y (): number {\r\n    return this._y\r\n  }\r\n\r\n  /**\r\n   * Set vector with both x and y values.\r\n   *\r\n   * @param {number} x new x value\r\n   * @param {number} y new y value\r\n   */\r\n  set (x: number, y: number): void {\r\n    this.x = x\r\n    this.y = y\r\n  }\r\n\r\n  /**\r\n   * Set vector location to another vector.\r\n   *\r\n   * @param {Vector2} vector other vector\r\n   */\r\n  setVector (vector: Vector2): void {\r\n    this.x = vector.x\r\n    this.y = vector.y\r\n  }\r\n\r\n  /**\r\n   * Add x and y to this vector.\r\n   *\r\n   * @param {number} x x value\r\n   * @param {number} y y value\r\n   */\r\n  add (x: number, y: number): void {\r\n    this.x += x\r\n    this.y += y\r\n  }\r\n\r\n  /**\r\n   * Add vector to this vector.\r\n   *\r\n   * @param {Vector2} vector other vector\r\n   */\r\n  addVector (vector: Vector2): void {\r\n    this.x += vector.x\r\n    this.y += vector.y\r\n  }\r\n\r\n  /**\r\n   * Subtraxt x and y from this vector.\r\n   *\r\n   * @param {number} x x value\r\n   * @param {number} y y value\r\n   */\r\n  subtract (x: number, y: number): void {\r\n    this.x -= x\r\n    this.y -= y\r\n  }\r\n\r\n  /**\r\n   * Subtract a vector from this vector.\r\n   *\r\n   * @param {Vector2} vector other vector\r\n   */\r\n  subtractVector (vector: Vector2): void {\r\n    this.x -= vector.x\r\n    this.y -= vector.y\r\n  }\r\n\r\n  /**\r\n   * Multiply this vector by scalar.\r\n   *\r\n   * @param scalar scalar to multiply the vector\r\n   */\r\n  multiply (scalar: number): void {\r\n    this.x *= scalar\r\n    this.y *= scalar\r\n  }\r\n\r\n  /**\r\n   * Divides this vector by a scalar.\r\n   * Throws error when trying to divide by zero.\r\n   *\r\n   * @param {number} scalar scalar used to divide this vector\r\n   */\r\n  divide (scalar: number): void {\r\n    if (scalar === 0) {\r\n      throw new Error('cannot divide vector by \"0\"')\r\n    }\r\n    this.x /= scalar\r\n    this.y /= scalar\r\n  }\r\n\r\n  /**\r\n   * Get the magnitude / elementsCount of this vector.\r\n   *\r\n   * @returns {number} magnitude / elementsCount of this vector\r\n   */\r\n  mag (): number {\r\n    return Math.sqrt(this.x * this.x + this.y * this.y)\r\n  }\r\n\r\n  /**\r\n   * Negate the x and y values of this vector and return the result as a new Vector2 object.\r\n   *\r\n   * @returns {Vector2}\r\n   */\r\n  negative (): Vector2 {\r\n    return new Vector2(-this.x, -this.y)\r\n  }\r\n\r\n  /**\r\n   * Normalize the vector.\r\n   */\r\n  normalize (): void {\r\n    let magnitude = this.mag()\r\n    if (magnitude !== 0) {\r\n      this.divide(magnitude)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Limit the vector to a maximum elementsCount.\r\n   *\r\n   * @param max maximum elementsCount\r\n   */\r\n  limit (max): void {\r\n    if (Math.floor(this.mag()) > max) {\r\n      this.normalize()\r\n      this.multiply(max)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get the distance of this vector to another vector.\r\n   *\r\n   * @param {Vector2} vector other vector\r\n   * @returns {number} calculated distance\r\n   */\r\n  distanceTo (vector: Vector2): number {\r\n    return Math.sqrt(Math.pow(vector.x - this.x, 2) + Math.pow(vector.y - this.y, 2))\r\n  }\r\n\r\n  /**\r\n   * Get the dot product between this vector and another vector.\r\n   *\r\n   * @param {Vector2} vector\r\n   * @returns {number} the dot product of this vector and the one passed as param.\r\n   */\r\n  dot (vector: Vector2): number {\r\n    return this.x * vector.x + this.y * vector.y\r\n  }\r\n\r\n  floor (): void {\r\n    this.x = Math.floor(this.x)\r\n    this.x = Math.floor(this.x)\r\n  }\r\n\r\n  /**\r\n   * Create a clone of this vector.\r\n   *\r\n   * @returns {Vector2} cloned vector\r\n   */\r\n  clone (): Vector2 {\r\n    return new Vector2(this.x, this.y)\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/math/Vector2.ts","import Observer from './Observer'\r\n\r\n/**\r\n * Observable class to be extended by a class that should be observed.\r\n *\r\n * @author Daniel Peters\r\n * @version 1.0\r\n */\r\nexport default class Observable {\r\n  private _observers: Observer[]\r\n  private _state: any\r\n\r\n  constructor () {\r\n    this._observers = []\r\n    this._state = {}\r\n  }\r\n\r\n  /**\r\n   * Register an observer on this observable.\r\n   *\r\n   * @param {Observer} observer Object implementing the Observer interface\r\n   */\r\n  register (observer: Observer): void {\r\n    this._observers.push(observer)\r\n  }\r\n\r\n  /**\r\n   * Remove an observer from this observables observers list.\r\n   *\r\n   * @param {Observer} observer Object implementing the Observer interface\r\n   */\r\n  unRegister (observer: Observer): void {\r\n    this._observers = this._observers.filter(obs => {\r\n      return obs !== observer\r\n    })\r\n  }\r\n\r\n  /**\r\n   * Notify all observers.\r\n   */\r\n  notify (): void {\r\n    this._observers.forEach(observer => {\r\n      observer.update(this._state)\r\n    })\r\n  }\r\n\r\n  /**\r\n   *\r\n   * @returns {Observer[]}\r\n   */\r\n  get observers (): Observer[] {\r\n    return this._observers\r\n  }\r\n\r\n  /**\r\n   *\r\n   * @param {Observer[]} observers\r\n   */\r\n  set observers (observers: Observer[]) {\r\n    this._observers = observers\r\n  }\r\n\r\n  /**\r\n   *\r\n   * @returns {any}\r\n   */\r\n  get state (): any {\r\n    return this._state\r\n  }\r\n\r\n  /**\r\n   *\r\n   * @param {any} state\r\n   */\r\n  set state (state: any) {\r\n    this._state = state\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/observer/Observable.ts","import Tetris from './Tetris'\nimport InputManager from '../client/InputManager'\nimport Settings from '../client/Settings'\nimport Piece from './Piece'\n\nconst settings = new Settings()\nconst inputManager = new InputManager(settings)\nconst canvas = document.getElementById('tetris') as HTMLCanvasElement\nconst tetris = new Tetris(canvas)\ntetris.addPlayer('p1', 'Daniel', new Piece(tetris.arena.matrix.mArray[0].length / 2, 0))\ninputManager.register(tetris.players[0])\ntetris.start()\n\n\n\n// WEBPACK FOOTER //\n// ./src/tetris/game.ts","import IGame from '../lib/interfaces/IGame'\nimport Player from './Player'\nimport Arena from './Arena'\nimport Vector2 from '../lib/math/Vector2'\nimport Piece from './Piece'\n\nconst colors = [\n  null,\n  '#FF0D72',\n  '#0DC2FF',\n  '#0DFF72',\n  '#F538FF',\n  '#FF8E0D',\n  '#FFE138',\n  '#3877FF'\n]\n\nexport default class Tetris implements IGame {\n  canvas: HTMLCanvasElement\n  context: CanvasRenderingContext2D\n  playing: boolean\n  lastTime: number\n  players: Player[]\n  arena: Arena\n\n  constructor (canvas: HTMLCanvasElement) {\n    this.canvas = canvas\n    this.context = canvas.getContext('2d')\n    this.playing = false\n    this.arena = new Arena()\n    this.players = []\n    this.lastTime = 0\n    this.context.scale(20, 20)\n  }\n\n  addPlayer (playerId: string, playerName: string, piece: Piece): void {\n    this.players.push(new Player(playerId, playerName, piece, this.arena))\n  }\n\n  start (): void {\n    this.playing = true\n    this.run()\n  }\n\n  drawMatrix (context: CanvasRenderingContext2D, matrix: number[][], offset: Vector2): void {\n    matrix.forEach((row, y) => {\n      row.forEach((value, x) => {\n        if (value !== 0) {\n          context.fillStyle = colors[value]\n          context.fillRect(x + offset.x,\n            y + offset.y,\n            1, 1)\n        }\n      })\n    })\n  }\n\n  animationCallback (timeStamp: number): void {\n    const deltaTime = timeStamp - this.lastTime\n    this.lastTime = timeStamp\n    this.update(deltaTime)\n    this.render()\n    requestAnimationFrame(this.animationCallback.bind(this))\n  }\n\n  update (deltaTime: number): void {\n    this.players.forEach(player => {\n      player.piece.dropCounter += deltaTime\n      if (player.piece.dropCounter > player.piece.dropInterval) {\n        player.piece.drop(this.arena, player)\n      }\n    })\n  }\n\n  render (): void {\n    this.context.fillStyle = '#000'\n    this.context.fillRect(0, 0, this.canvas.width, this.canvas.height)\n    this.drawMatrix(this.context, this.arena.matrix.mArray, this.arena.postition)\n    this.drawMatrix(this.context, this.players[0].piece.matrix.mArray, this.players[0].piece.position)\n  }\n\n  run (): void {\n    requestAnimationFrame(this.animationCallback.bind(this))\n  }\n\n  stop (): void {\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/tetris/Tetris.ts","import Piece from './Piece'\nimport Observer from '../lib/observer/Observer'\nimport { Actions } from '../client/InputManager'\nimport Arena from './Arena'\n\nexport default class Player implements Observer {\n  piece: Piece\n  arena: Arena\n  id: string\n  name: string\n  score: number\n  state\n\n  constructor (id: string, name: string, piece: Piece, arena: Arena) {\n    this.id = id\n    this.name = name\n    this.score = 0\n    this.state = {}\n    this.piece = piece\n    this.arena = arena\n  }\n\n  update (state: any): void {\n    this.state = state\n    this.move(this.arena)\n  }\n\n  move (arena: Arena): void {\n    if (this.state[Actions.LEFT]) {\n      this.piece.move(-1)\n    }\n    if (this.state[Actions.RIGHT]) {\n      this.piece.move(1)\n    }\n    if (this.state[Actions.DOWN]) {\n      this.piece.drop(arena, this)\n    }\n    if (this.state[Actions.ROTATE_LEFT]) {\n      this.piece.rotate(arena, this, -1)\n    }\n    if (this.state[Actions.ROTATE_RIGHT]) {\n      this.piece.rotate(arena, this, 1)\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/tetris/Player.ts","import Matrix from '../lib/math/Matrix'\nimport Player from './Player'\nimport Vector2 from '../lib/math/Vector2'\n\nexport default class Arena {\n  matrix: Matrix\n  postition: Vector2\n\n  constructor () {\n    this.postition = new Vector2(0, 0)\n    this.init(12, 20)\n  }\n\n  init (width: number, height: number): void {\n    const array = []\n    while (height--) {\n      array.push(new Array(width).fill(0))\n    }\n    this.matrix = new Matrix(array)\n  }\n\n  sweep (player: Player): void {\n    let rowCount = 1\n    outer: for (let y = this.matrix.mArray.length - 1; y > 0; --y) {\n      for (let x = 0; x < this.matrix.mArray[y].length; ++x) {\n        if (this.matrix.mArray[y][x] === 0) {\n          continue outer\n        }\n      }\n\n      const row = this.matrix.mArray.splice(y, 1)[0].fill(0)\n      this.matrix.mArray.unshift(row)\n      ++y\n\n      player.score += rowCount * 10\n      rowCount *= 2\n    }\n  }\n\n  merge (player: Player): void {\n    player.piece.matrix.mArray.forEach((row, y) => {\n      row.forEach((value, x) => {\n        if (value !== 0) {\n          this.matrix.mArray[y + player.piece.position.y][x + player.piece.position.x] = value\n        }\n      })\n    })\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/tetris/Arena.ts","import Matrix from '../lib/math/Matrix'\nimport Vector2 from '../lib/math/Vector2'\nimport CollideAble, { EntityType } from '../game/interfaces/CollideAble'\nimport MatrixCollisionManager from '../lib/collision/MatrixCollisionManager'\nimport Arena from './Arena'\nimport Player from './Player'\n\nexport const types = {\n  I: [\n    [0, 1, 0, 0],\n    [0, 1, 0, 0],\n    [0, 1, 0, 0],\n    [0, 1, 0, 0]\n  ],\n  L: [\n    [0, 2, 0],\n    [0, 2, 0],\n    [0, 2, 2]\n  ],\n  J: [\n    [0, 3, 0],\n    [0, 3, 0],\n    [3, 3, 0]\n  ],\n  O: [\n    [4, 4],\n    [4, 4]\n  ],\n  Z: [\n    [5, 5, 0],\n    [0, 5, 5],\n    [0, 0, 0]\n  ],\n  S: [\n    [0, 6, 6],\n    [6, 6, 0],\n    [0, 0, 0]\n  ],\n  T: [\n    [0, 7, 0],\n    [7, 7, 7],\n    [0, 0, 0]\n  ]\n}\n\n/**\n * Tetris piece representation.\n *\n * @author Daniel Peters\n * @version 1.0\n */\nexport default class Piece implements CollideAble {\n  position: Vector2\n  matrix: Matrix\n  type: EntityType\n  collidesWith\n  colliding: boolean\n  dropCounter: number\n  dropInterval: number\n\n  /**\n   * Default constructor.\n   *\n   * @param {number} x X position\n   * @param {number} y Y position\n   * @param {Matrix} matrix Matrix representing the piece\n   */\n  constructor (x: number, y: number) {\n    this.position = new Vector2(x, y)\n    this.matrix = new Matrix([[0]])\n    this.setRandom()\n    this.collidesWith = []\n    this.collidesWith.push(EntityType.ARENA)\n    this.colliding = false\n    this.dropCounter = 0\n    this.dropInterval = 1000\n  }\n\n  move (offset: number): void {\n    this.position.add(offset, 0)\n  }\n\n  rotate (arena: Arena, player: Player, direction: number): void {\n    const pos = player.piece.position.x\n    let offset = 1\n    this.matrix.rotate(direction)\n\n    while (MatrixCollisionManager.detectCollision(arena, player)) {\n      player.piece.position.x += offset\n      offset = -(offset + (offset > 0 ? 1 : -1))\n      if (offset > player.piece.matrix.mArray[0].length) {\n        player.piece.matrix.rotate(-direction)\n        player.piece.position.x = pos\n        return\n      }\n    }\n  }\n\n  drop (arena: Arena, player: Player): void {\n    this.position.add(0, 1)\n    if (MatrixCollisionManager.detectCollision(arena, player)) {\n      this.position.add(0, -1)\n      arena.merge(player)\n      this.reset(arena, player)\n      arena.sweep(player)\n    }\n    this.dropCounter = 0\n  }\n\n  isCollideAbleWith (other: CollideAble): boolean {\n    return this.collidesWith.includes(other.type.toString())\n  }\n\n  setRandom (): void {\n    const pieces = 'TJLOSZI'\n    this.matrix.set(types[pieces[pieces.length * Math.random() | 0]])\n  }\n\n  reset (arena: Arena, player: Player): void {\n    this.setRandom()\n    this.position.set((arena.matrix.mArray[0].length / 2 | 0) - (this.matrix.mArray[0].length / 2 | 0), 0)\n\n    if (MatrixCollisionManager.detectCollision(arena, player)) {\n      arena.matrix.mArray.forEach(row => row.fill(0))\n      player.score = 0\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/tetris/Piece.ts","export default class MatrixCollisionManager {\n  static detectCollision (arena, player): boolean {\n    const arenaMatrix = arena.matrix.mArray\n    const m = player.piece.matrix.mArray\n    const o = player.piece.position\n    for (let y = 0; y < m.length; ++y) {\n      for (let x = 0; x < m[y].length; ++x) {\n        if (m[y][x] !== 0 &&\n          (arenaMatrix[y + o.y] &&\n            arenaMatrix[y + o.y][x + o.x]) !== 0) {\n          return true\n        }\n      }\n    }\n    return false\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/collision/MatrixCollisionManager.ts","import { Actions } from './InputManager'\r\n\r\n/**\r\n * Settings class for game applications.\r\n *\r\n * @author Daniel Peters\r\n * @version 1.0\r\n */\r\nexport default class Settings {\r\n  keyBoard\r\n  player\r\n  audio\r\n\r\n  constructor () {\r\n    this.keyBoard = {\r\n      'w': Actions.UP,\r\n      's': Actions.DOWN,\r\n      'a': Actions.LEFT,\r\n      'd': Actions.RIGHT,\r\n      'space': Actions.SHOOT,\r\n      'r': Actions.RESTART,\r\n      'q': Actions.ROTATE_LEFT,\r\n      'e': Actions.ROTATE_RIGHT\r\n    }\r\n    this.player = {\r\n      maxVelocity: 15,\r\n      fireDelay: 15,\r\n      friction: 0.7,\r\n      acceleration: 3\r\n    }\r\n    this.audio = {\r\n      master: 1,\r\n      ambient: 1,\r\n      effects: 1\r\n    }\r\n  }\r\n\r\n  findKey (value): string {\r\n    return Object.keys(this.keyBoard).filter(key => this.keyBoard[key] === value)[0]\r\n  }\r\n\r\n  setKey (newKey, action: Actions): void {\r\n    let oldKey = this.findKey(action)\r\n    if (newKey !== oldKey) {\r\n      console.log('old:' + oldKey, ' new: ' + newKey + ' value: ' + action)\r\n      this.keyBoard[newKey] = this.keyBoard[oldKey]\r\n      delete this.keyBoard[oldKey]\r\n    }\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/client/Settings.ts","/**\r\n * Matrix class.\r\n *\r\n * @author Daniel Peters\r\n * @version 1.0\r\n */\r\nexport default class Matrix {\r\n  rows: number\r\n  columns: number\r\n  mArray: number[][]\r\n\r\n  /**\r\n   * Default constructor.\r\n   *\r\n   * @param {number[][]} mArray Matrix array\r\n   */\r\n  constructor (mArray: number[][]) {\r\n    this.mArray = mArray\r\n    this.rows = mArray.length\r\n    this.columns = mArray[0].length\r\n  }\r\n\r\n  set (array: number[][]): void {\r\n    const length = array[0].length\r\n    let valid = true\r\n    for (let i = 1; i < array.length; i++) {\r\n      if (array[i].length !== length) {\r\n        valid = false\r\n      }\r\n    }\r\n    if (valid) {\r\n      this.rows = array.length\r\n      this.columns = array[0].length\r\n      this.mArray = array\r\n    } else {\r\n      throw new Error('The passed matrix array is malformed: ' + array)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Add another matrix to this matrix.\r\n   * The dimension of the other matrix must be equal to this.\r\n   *\r\n   * @param {Matrix} matrix\r\n   */\r\n  add (matrix: Matrix): void {\r\n    if (this.equals(matrix)) {\r\n      for (let i = 0; i < this.rows; i++) {\r\n        for (let j = 0; j < this.columns; j++) {\r\n          this.mArray[i][j] += matrix.mArray[i][j]\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Subtract another matrix from this matrix.\r\n   * The dimension of the other matrix must be equal to this.\r\n   *\r\n   * @param {Matrix} matrix\r\n   */\r\n  subtract (matrix: Matrix): void {\r\n    if (this.equals(matrix)) {\r\n      for (let i = 0; i < this.rows; i++) {\r\n        for (let j = 0; j < this.columns; j++) {\r\n          this.mArray[i][j] -= matrix.mArray[i][j]\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Matrix multiplication algorithm.\r\n   *\r\n   * @param {Matrix} matrix Another matrix\r\n   * @returns {Matrix} Resulting matrix\r\n   */\r\n  multiply (matrix: Matrix): Matrix {\r\n    let newArray = []\r\n    if (this.columns === matrix.rows) {\r\n      for (let i = 0; i < this.rows; i++) {\r\n        newArray[i] = []\r\n        for (let j = 0; j < matrix.columns; j++) {\r\n          let val = 0\r\n          for (let k = 0; k < this.columns; k++) {\r\n            val += this.mArray[i][k] * matrix.mArray[k][j]\r\n          }\r\n          newArray[i].push(val)\r\n        }\r\n      }\r\n    } else {\r\n      return null\r\n    }\r\n    return new Matrix(newArray)\r\n  }\r\n\r\n  /**\r\n   * Multiply this matrix by a scalar.\r\n   *\r\n   * @param {number} scalar Scalar by which the matrix is multiplied by\r\n   */\r\n  multScalar (scalar: number): void {\r\n    for (let i = 0; i < this.rows; i++) {\r\n      for (let j = 0; j < this.columns; j++) {\r\n        this.mArray[i][j] *= scalar\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Transposes this matrix.\r\n   */\r\n  transpose (): void {\r\n    let array = []\r\n    for (let i = 0; i < this.columns; i++) {\r\n      array[i] = []\r\n      for (let j = 0; j < this.rows; j++) {\r\n        array[i][j] = this.mArray[j][i]\r\n      }\r\n    }\r\n\r\n    this.rows = array.length\r\n    this.columns = array[0].length\r\n    this.mArray = array\r\n  }\r\n\r\n  rotate (direction: number): void {\r\n    this.transpose()\r\n    if (direction > 0) {\r\n      this.mArray.forEach(row => row.reverse())\r\n    } else {\r\n      this.mArray.reverse()\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Check if the row and column length are equal to another matrix's.\r\n   *\r\n   * @param {Matrix} other Other Matrix\r\n   * @returns {boolean} Returns true if the lengths match\r\n   */\r\n  equals (other: Matrix): boolean {\r\n    return other.rows === this.rows && other.columns === this.columns\r\n  }\r\n\r\n  /**\r\n   * Generate an exact copy of this matrix.\r\n   *\r\n   * @returns {Matrix} A copy of this matrix\r\n   */\r\n  clone (): Matrix {\r\n    let array = []\r\n    this.mArray.forEach(arr => array.push(arr.slice(0)))\r\n    return new Matrix(Array.from(array))\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/math/Matrix.ts"],"sourceRoot":""}