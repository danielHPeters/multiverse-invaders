!function(t){var e={};function s(i){if(e[i])return e[i].exports;var n=e[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=t,s.c=e,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},s.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=27)}([function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.PLAYER="ship",t.ENEMY="enemy",t.ENEMY_BULLET="bulletEnemy",t.PLAYER_BULLET="bullet",t.BACKGROUND="background",t.MAP="map",t.GAME_OVER="gameOver",t.LASER="laser",t.MAIN_THEME="shockWave",t.EXPLOSION_I="explosion1",t.EXPLOSION_II="explosion2",t.BOX="box",t.ARENA="arena"}(e.EntityType||(e.EntityType={}))},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class i{constructor(t,e){this.x=t,this.y=e}static addVector(t,e){return new i(t.x+e.x,t.y+e.y)}static subtractVector(t,e){return new i(t.x-e.x,t.y-e.y)}static multiply(t,e){return new i(t.x*e,t.y*e)}static divide(t,e){if(0===e)throw new Error('cannot divide vector by scalar with value "0"');return new i(t.x/e,t.y/e)}set x(t){this._x=t}set y(t){this._y=t}get x(){return this._x}get y(){return this._y}set(t,e){this.x=t,this.y=e}setVector(t){this.x=t.x,this.y=t.y}add(t,e){this.x+=t,this.y+=e}addVector(t){this.x+=t.x,this.y+=t.y}subtract(t,e){this.x-=t,this.y-=e}subtractVector(t){this.x-=t.x,this.y-=t.y}multiply(t){this.x*=t,this.y*=t}divide(t){if(0===t)throw new Error('cannot divide vector by "0"');this.x/=t,this.y/=t}mag(){return Math.sqrt(this.x*this.x+this.y*this.y)}negative(){return new i(-this.x,-this.y)}normalize(){let t=this.mag();0!==t&&this.divide(t)}limit(t){Math.floor(this.mag())>t&&(this.normalize(),this.multiply(t))}distanceTo(t){return Math.sqrt(Math.pow(t.x-this.x,2)+Math.pow(t.y-this.y,2))}dot(t){return this.x*t.x+this.y*t.y}floor(){this.x=Math.floor(this.x),this.x=Math.floor(this.x)}clone(){return new i(this.x,this.y)}}e.default=i},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(t,e){this.width=t,this.height=e}scale(t){this.width*=t,this.height*=t}}},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(t,e,s){this.position=t,this.dimension=e,this.settings=s}init(){}}},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=s(22);!function(t){t.UP="UP",t.DOWN="DOWN",t.LEFT="LEFT",t.RIGHT="RIGHT",t.SHOOT="SHOOT",t.RESTART="RESTART",t.ROTATE_LEFT="R-LEFT",t.ROTATE_RIGHT="R-RIGHT"}(e.Actions||(e.Actions={})),e.default=class extends i.default{constructor(t){super(),this.inputMap=t.keyBoard,this.init(),this.initializeTouchHandler(),this.touches={start:[],move:[]}}init(){window.addEventListener("keydown",t=>{let e=" "!==t.key?t.key:"space";this.state[this.inputMap[e]]=!0,this.notify()}),window.addEventListener("keyup",t=>{let e=" "!==t.key?t.key:"space";this.state[this.inputMap[e]]=!1,this.notify()})}initializeTouchHandler(){let t=document.getElementById("move")||window;t.addEventListener("touchstart",function(t){t.preventDefault(),e=t.touches,i=t.touches[0].pageX,n=t.touches[0].pageY},!1),t.addEventListener("touchmove",function(t){h.reset(),t.preventDefault(),s=t.changedTouches,o=t.touches[0].pageX,a=t.touches[0].pageY;for(let i=0;i<t.touches.length;i++)s[i].pageX<e[i].pageX&&(h.state[h.inputMap.a]=!0),s[i].pageX>e[i].pageX&&(h.state[h.inputMap.d]=!0),s[i].pageY<e[i].pageY&&(h.state[h.inputMap.w]=!0),s[i].pageY>e[i].pageY&&(h.state[h.inputMap.s]=!0),h.notify()},!1),t.addEventListener("touchend",function(t){t.preventDefault(),h.reset()},!1),t.addEventListener("contextmenu",t=>(t.preventDefault(),!1));let e=[],s=[],i=0,n=0,o=0,a=0,h=this}shoot(){this.state[this.inputMap.space]=!0}cancelShoot(){this.state[this.inputMap.space]=!1}reset(){this.state[this.inputMap.w]=!1,this.state[this.inputMap.a]=!1,this.state[this.inputMap.s]=!1,this.state[this.inputMap.d]=!1}}},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.BACKGROUND=0]="BACKGROUND",t[t.MAIN=1]="MAIN",t[t.SHIP=2]="SHIP"}(e.ContextId||(e.ContextId={}))},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.PLAYER="ship",t.ENEMY="enemy",t.ENEMY_BULLET="bulletEnemy",t.PLAYER_BULLET="bullet",t.BACKGROUND="background",t.MAP="map",t.GAME_OVER="gameOver",t.LASER="laser",t.MAIN_THEME="shockWave",t.EXPLOSION_I="explosion1",t.EXPLOSION_II="explosion2",t.BOX="box",t.ARENA="arena"}(e.AssetId||(e.AssetId={}))},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=s(26),n=s(25);var o;!function(t){t.SPRITE="SPRITE",t.SPRITE_SHEET="SPRITE_SHEET",t.AUDIO="AUDIO",t.AUDIO_AMB="LOOP"}(o=e.AssetType||(e.AssetType={})),e.default=class{constructor(t){this.cache={sprites:{},spriteSheets:{},audio:{}},this.downloadCount=0,this.queue=[],this.audioManager=t}done(){return this.downloadCount===this.queue.length}queueDownload(t,e,s,i=null){this.queue.push({id:t,path:e,type:s,opts:i})}loadAudio(t,e){n.default.create({method:"GET",url:t.path,responseType:"arraybuffer"},s=>{this.audioManager.decodeAudio(s,t.id,s=>{this.cache.audio[t.id]=s,this.downloadCount+=1,this.done()&&e()})})}loadSprite(t,e){let s=new Image;s.addEventListener("load",()=>{this.downloadCount++,this.done()&&e()}),s.src=t.path,this.cache.sprites[t.id]=s}loadSpriteSheet(t,e){let s=new Image;s.addEventListener("load",()=>{this.cache.spriteSheets[t.id]=new i.default(s,t.opts.frameWidth||0,t.opts.frameHeight||0),this.downloadCount+=1,this.done()&&e()}),s.src=t.path}downloadAll(t){this.queue.forEach(e=>{e.type===o.AUDIO?this.loadAudio(e,t):e.type===o.SPRITE?this.loadSprite(e,t):e.type===o.SPRITE_SHEET&&this.loadSpriteSheet(e,t)})}getSound(t,e){let s=e===o.AUDIO_AMB;return this.audioManager.createSound(this.cache.audio[t],s)}getSprite(t){return this.cache.sprites[t]}getSpriteSheet(t){return this.cache.spriteSheets[t]}}},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=s(1),n=s(0);e.default=class{constructor(t,e,s,o){this.position=new i.default(t,e),this.width=s,this.height=o,this.colliding=!1,this.collidesWith=[],this.type=n.EntityType.BOX,this.collidesWith.push(n.EntityType.PLAYER)}isCollideAbleWith(t){return this.collidesWith.includes(t.type.toString())}}},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{static registerOnElement(t,e,s){e.forEach(e=>t.addEventListener(e,s))}}},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=s(1),n=s(0),o=s(3),a=s(2);e.default=class extends o.default{constructor(t,e,s,o,h,r,d,l,u){super(new i.default(t,e),new a.default(s,o),u),this.speed=h,this.sprite=r,this.percentFire=.001,this.chance=0,this.alive=!1,this.type=d,this.collidesWith=[],this.collidesWith.push(n.EntityType.PLAYER_BULLET),this.colliding=!1,this.bulletPool=l}spawn(t,e,s){this.position.x=t,this.position.y=e,this.speed=s,this.speedX=0,this.speedY=s,this.alive=!0,this.leftEdge=this.position.x-180,this.rightEdge=this.position.x+180,this.bottomEdge=this.position.y+280}clear(t){t.clearRect(this.position.x-1,this.position.y,this.dimension.width+1,this.dimension.height)}move(t){this.colliding||(this.position.x+=this.speedX,this.position.y+=this.speedY,this.position.x<=this.leftEdge?this.speedX=this.speed:this.position.x>=this.rightEdge+this.dimension.width?this.speedX=-this.speed:this.position.y>=this.bottomEdge&&(this.speed=1.5,this.speedY=0,this.position.y-=5,this.speedX=-this.speed),this.chance=Math.floor(101*Math.random()),this.chance/100<this.percentFire&&this.fire())}render(t){t.drawImage(this.sprite,this.position.x,this.position.y)}fire(){this.bulletPool.get(Math.floor(this.position.x+this.dimension.width/2),Math.floor(this.position.y+this.dimension.height),-5)}reset(){this.position.x=0,this.position.y=0,this.speed=0,this.speedX=0,this.speedY=0,this.alive=!1,this.colliding=!1}isCollideAbleWith(t){return this.collidesWith.includes(t.type.toString())}}},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=s(1),n=s(0),o=s(3),a=s(2);e.default=class extends o.default{constructor(t,e,s,o,h,r,d,l){super(new i.default(t,e),new a.default(s,o),l),this.speed=h,this.sprite=r,this.alive=!1,this.type=d,this.colliding=!1,this.collidesWith=[],this.type===n.EntityType.PLAYER_BULLET?this.collidesWith.push(n.EntityType.ENEMY):this.type===n.EntityType.ENEMY_BULLET&&this.collidesWith.push(n.EntityType.PLAYER),this.settings=l}spawn(t,e,s){this.position.set(t,e),this.speed=s,this.alive=!0}move(t){this.position.y-=this.speed}clear(t){t.clearRect(this.position.x-1,this.position.y-1,this.dimension.width+1,this.dimension.height+1)}render(t){t.drawImage(this.sprite,this.position.x,this.position.y)}reset(){this.position.set(0,0),this.speed=0,this.alive=!1,this.colliding=!1}isCollideAbleWith(t){return this.collidesWith.includes(t.type.toString())}}},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=s(11),n=s(10),o=s(0),a=s(5);e.default=class{constructor(t,e,s,i,n,o=null){this.assetManager=t,this.maxSize=e,this.type=s,this.assetId=i,this.pool=[],this.subPool=o,this.settings=n,this.contextId=a.ContextId.MAIN,this.init()}init(){let t=this.assetManager.getSprite(this.assetId);if(this.type===o.EntityType.ENEMY)for(let e=0;e<this.maxSize;e++)this.pool[e]=new n.default(0,0,t.width,t.height,0,t,this.type,this.subPool,this.settings);else for(let e=0;e<this.maxSize;e++)this.pool[e]=new i.default(0,0,t.width,t.height,0,t,this.type,this.settings)}get(t,e,s){let i=this.pool[this.maxSize-1];i.alive||(i.spawn(t,e,s),this.pool.unshift(this.pool.pop()))}getTwo(t,e,s,i,n,o){this.pool[this.maxSize-1].alive||this.pool[this.maxSize-2].alive||(this.get(t,e,s),this.get(i,n,o))}render(t){for(let e=0;e<this.pool.length&&this.pool[e].alive;e++)this.pool[e].render(t),this.pool[e].reset(),this.pool.push(this.pool.splice(e,1)[0])}move(t){this.pool.forEach(e=>e.move(t))}clearAll(){this.pool.forEach(t=>t.reset())}getPool(){let t=[];return this.pool.forEach(e=>{e.alive&&t.push(e)}),t}clear(t){this.pool.forEach(e=>e.clear(t))}}},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=s(1),n=s(0),o=s(5),a=s(3),h=s(2);e.default=class extends a.default{constructor(t,e,s,a,r,d){super(new i.default(t,e),new h.default(s,a),d),this.speed=1,this.sprite=r,this.type=n.EntityType.BACKGROUND,this.contextId=o.ContextId.BACKGROUND}reset(){this.position.set(0,0)}move(t){this.position.y+=this.speed,this.position.y>=this.dimension.height&&(this.position.y=0)}render(t){t.drawImage(this.sprite,this.position.x,this.position.y),t.drawImage(this.sprite,this.position.x,this.position.y-this.dimension.height)}clear(){}}},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=s(1),n=s(0),o=s(4),a=s(7),h=s(6),r=s(3),d=s(2),l=s(5);e.default=class extends r.default{constructor(t,e,s,o,r){super(new i.default(0,0),new d.default(t,e),r),this.startPosition=new i.default(0,0),this.acceleration=new i.default(0,0),this.velocity=new i.default(0,0),this.sprite=s.getSprite(h.AssetId.PLAYER),this.type=n.EntityType.PLAYER,this.pool=o,this.counter=0,this.collidesWith=[],this.collidesWith.push(n.EntityType.ENEMY_BULLET),this.colliding=!1,this.state={},this.settings=r,this.assetManager=s,this.maxTop=Math.floor(this.settings.gameSize.height/4*3),this.laserSound=s.getSound(h.AssetId.LASER,a.AssetType.AUDIO),this.contextId=l.ContextId.SHIP}init(){const t=this.settings.gameSize.width/2-this.assetManager.getSprite(h.AssetId.PLAYER).width,e=this.settings.gameSize.height/4*3+2*this.assetManager.getSprite(h.AssetId.PLAYER).height;this.position.setVector(new i.default(t,e)),this.velocity.set(0,0),this.colliding=!1}clear(t){t.clearRect(Math.floor(this.position.x),Math.floor(this.position.y),this.dimension.width,this.dimension.height)}move(t){if(!this.colliding){this.counter++,this.acceleration.set(0,0),this.state[o.Actions.LEFT]&&this.acceleration.add(-this.settings.player.acceleration,0),this.state[o.Actions.RIGHT]&&this.acceleration.add(this.settings.player.acceleration,0),this.state[o.Actions.UP]&&this.acceleration.add(0,-this.settings.player.acceleration),this.state[o.Actions.DOWN]&&this.acceleration.add(0,this.settings.player.acceleration),this.velocity.multiply(this.settings.player.friction),this.velocity.addVector(this.acceleration),this.velocity.limit(this.settings.player.maxVelocity);const e=this.velocity.clone();e.multiply(t),this.position.addVector(e),this.position.x<=0&&(this.position.x=0,this.velocity.x+=-1),this.position.x>=this.settings.gameSize.width-this.dimension.width&&(this.position.x=this.settings.gameSize.width-this.dimension.width),this.position.y<=this.maxTop&&(this.position.y=this.maxTop),this.position.y>=this.settings.gameSize.height-this.dimension.height&&(this.position.y=this.settings.gameSize.height-this.dimension.height),this.state[o.Actions.SHOOT]&&this.counter>=this.settings.player.fireDelay&&!this.colliding&&(this.fire(),this.counter=0)}}alive(){return!this.colliding}render(t){t.drawImage(this.sprite,Math.floor(this.position.x),Math.floor(this.position.y))}update(t){this.state=t}fire(){this.pool.getTwo(Math.floor(this.position.x)+12,Math.floor(this.position.y),6,Math.floor(this.position.x)+66,Math.floor(this.position.y),6),this.laserSound.play()}isCollideAbleWith(t){return this.collidesWith.includes(t.type.toString())}}},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=s(8);class n{constructor(t=new i.default(0,0,0,0),e=0){this.level=e,this.maxObjects=10,this.maxLevels=5,this.hitBox=t,this.objects=[],this.nodes=[]}clear(){this.objects=[],this.nodes.forEach(t=>t.clear()),this.nodes=[]}getAllObjects(t){return this.nodes.forEach(e=>e.getAllObjects(t)),this.objects.forEach(e=>t.push(e)),t}findObjects(t,e){if(void 0===e)return void console.log("UNDEFINED OBJECT");let s=this.getIndex(e);return-1!==s&&this.nodes.length&&this.nodes[s].findObjects(t,e),this.objects.forEach(e=>t.push(e)),t}insert(t){if(void 0!==t)if(t instanceof Array)t.forEach(t=>this.insert(t));else{if(this.nodes.length>0){let e=this.getIndex(t);if(-1!==e)return void this.nodes[e].insert(t)}if(this.objects.push(t),this.objects.length>this.maxObjects&&this.level<this.maxLevels){void 0===this.nodes[0]&&this.split();let t=0;for(;t<this.objects.length;){let e=this.getIndex(this.objects[t]);-1!==e?this.nodes[e].insert(this.objects.splice(t,1)[0]):t++}}}}getIndex(t){let e=-1,s=this.hitBox.position.x+this.hitBox.width/2,i=this.hitBox.position.y+this.hitBox.height/2,n=t.position.y<i&&t.position.y+t.height<i,o=t.position.y>i;return t.position.x<s&&t.position.x+t.width<s?n?e=1:o&&(e=2):t.position.x>s&&(n?e=0:o&&(e=3)),e}split(){let t=this.hitBox.width/2|0,e=this.hitBox.height/2|0;this.nodes[0]=new n(new i.default(this.hitBox.position.x+t,this.hitBox.position.y,t,e),this.level+1),this.nodes[1]=new n(new i.default(this.hitBox.position.x,this.hitBox.position.y,t,e),this.level+1),this.nodes[2]=new n(new i.default(this.hitBox.position.x,this.hitBox.position.y+e,t,e),this.level+1),this.nodes[3]=new n(new i.default(this.hitBox.position.x+t,this.hitBox.position.y+e,t,e),this.level+1)}}e.default=n},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=s(0),n=s(15),o=s(7),a=s(14),h=s(8),r=s(6),d=s(13),l=s(12);e.default=class{constructor(t,e,s){this.assetManager=s,this.running=!1,this.paused=!1,this.playerScore=0;const u=new d.default(0,0,t.gameSize.width,t.gameSize.height,s.getSprite(r.AssetId.BACKGROUND),t),c=new l.default(this.assetManager,80,i.EntityType.PLAYER_BULLET,r.AssetId.PLAYER_BULLET,t),p=new a.default(s.getSprite(r.AssetId.PLAYER).width,s.getSprite(r.AssetId.PLAYER).height,s,c,t),m=new l.default(this.assetManager,50,i.EntityType.ENEMY_BULLET,r.AssetId.ENEMY_BULLET,t),g=new l.default(this.assetManager,30,i.EntityType.ENEMY,r.AssetId.ENEMY,t,m);this.quadTree=new n.default(new h.default(0,0,t.gameSize.width,t.gameSize.height)),this.pools=[],this.entities=[],this.renderables=[],this.collideables=[],this.movables=[],this.pools.push(c),this.pools.push(m),this.pools.push(g),this.entities.push(p),this.movables.push(p),this.renderables.push(p),this.entities.push(u),this.movables.push(u),this.movables.push(g),this.movables.push(c),this.movables.push(m),this.renderables.push(u),this.renderables.push(c),this.renderables.push(m),this.renderables.push(g),this.backgroundAudio=this.assetManager.getSound(r.AssetId.MAIN_THEME,o.AssetType.AUDIO_AMB),this.backgroundAudio.play(!0),this.spawnWave(),e.register(p)}spawnWave(){const t=this.assetManager.getSprite(r.AssetId.ENEMY).height,e=this.assetManager.getSprite(r.AssetId.ENEMY).width;let s=200,i=-t;const n=1.5*i;for(let t=1;t<=21;t++)this.pools[1].get(s,i,4),s+=e+25,t%7==0&&(s=200,i+=n)}scorePoints(){this.playerScore+=10}gameOver(){this.backgroundAudio.stop(),document.getElementById("game-over").style.display="block",this.gameOverAudio=this.assetManager.getSound(r.AssetId.GAME_OVER,o.AssetType.AUDIO_AMB),this.gameOverAudio.play(!0)}reset(){this.gameOverAudio.stop(),this.backgroundAudio.play(!0),document.getElementById("game-over").style.display="none",this.quadTree.clear(),this.entities.forEach(t=>t.init()),this.pools.forEach(t=>t.clearAll()),this.playerScore=0}}},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(t){this.game=t,this.lastTime=null}start(){this.game.init(),this.game.state.running=!0,this.frameId=requestAnimationFrame(t=>this.loop(t))}stop(){this.game.state.running=!1,this.frameId&&cancelAnimationFrame(this.frameId)}restart(){this.stop(),this.start()}togglePause(){this.game.state.paused=!this.game.state.paused}loop(t){if(this.game.state.running){if(this.game.clear(),null!==this.lastTime){const e=t-this.lastTime;this.game.state.paused||this.game.update(e/1e3)}this.lastTime=t,this.game.render(),this.frameId=requestAnimationFrame(t=>this.loop(t))}}}},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(t,e,s){this.audioContext=t,this.masterGain=e,this.buffer=s,this.gainNode=this.audioContext.createGain(),this.gainNode.gain.value=.2,this.gainNode.connect(this.masterGain),this.playing=!1}play(t=!1){this.source=this.audioContext.createBufferSource(),this.source.buffer=this.buffer,this.source.loop=t,this.source.connect(this.gainNode),this.source.start(0)}stop(){this.source.stop(0)}}},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=s(18);e.default=class{constructor(){this.initAudioContext()}initAudioContext(){try{window.AudioContext=window.AudioContext||webkitAudioContext,this.audioContext=new AudioContext,this.masterGain=this.audioContext.createGain(),this.effectsGain=this.audioContext.createGain(),this.ambientGain=this.audioContext.createGain(),this.masterGain.gain.value=1,this.masterGain.connect(this.audioContext.destination),this.effectsGain.connect(this.masterGain),this.ambientGain.connect(this.masterGain),this.ambientGain.gain.value=1,this.effectsGain.gain.value=1}catch(t){console.log("Web Audio API is not supported in this browser")}}decodeAudio(t,e,s){this.audioContext.decodeAudioData(t).then(t=>s(t),t=>{console.log("Error with decoding audio data"+t)})}adjustMasterVolume(t){this.masterGain.gain.value=t}adjustAmbientVolume(t){this.ambientGain.gain.value=t}adjustEffectsVolume(t){this.effectsGain.gain.value=t}createSound(t,e){return new i.default(this.audioContext,e?this.ambientGain:this.effectsGain,t)}}},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=s(4),n=s(9);e.default=class{constructor(t,e,s,i){this.element=t,this.settings=e,this.assetManager=s,this.audioManager=i,this.showing=!1}createMainMenu(){this.mainMenu=document.createElement("div"),this.mainMenu.classList.add("tab"),this.element.appendChild(this.mainMenu)}openTab(t,e){let s,i;s=document.getElementsByClassName("tabContent");for(let t=0;t<s.length;t++)s[t].style.display="none";i=document.getElementsByClassName("tabLink");for(let t=0;t<i.length;t++)i[t].className=i[t].className.replace(" active","");document.getElementById(e).style.display="block",t.currentTarget.className+=" active"}createKeyboardMenu(){let t=document.createElement("button"),e=document.createElement("div"),s=document.createElement("h4"),o=document.createElement("form"),a=document.createElement("input");n.default.registerOnElement(t,["click","touchstart"],t=>this.openTab(t,"keyboardMenu")),t.appendChild(document.createTextNode("Keyboard")),t.classList.add("tabLink"),this.mainMenu.appendChild(t),e.setAttribute("id","keyboardMenu"),e.classList.add("tabContent"),s.appendChild(document.createTextNode("Keyboard")),o.setAttribute("id","keyboardSettings"),o.setAttribute("method","post"),a.setAttribute("type","submit"),a.setAttribute("value","Save"),e.appendChild(s),e.appendChild(o),this.element.appendChild(e),Object.keys(this.settings.keyBoard).forEach(t=>this.addEntry(t,o)),o.appendChild(a),o.addEventListener("submit",t=>{t.preventDefault(),this.settings.setKey(document.getElementById(i.Actions.UP).value,i.Actions.UP),this.settings.setKey(document.getElementById(i.Actions.DOWN).value,i.Actions.DOWN),this.settings.setKey(document.getElementById(i.Actions.LEFT).value,i.Actions.LEFT),this.settings.setKey(document.getElementById(i.Actions.RIGHT).value,i.Actions.RIGHT),this.settings.setKey(document.getElementById(i.Actions.SHOOT).value,i.Actions.SHOOT),this.settings.setKey(document.getElementById(i.Actions.RESTART).value,i.Actions.RESTART),this.clear()})}createPlayerMenu(){let t=document.createElement("button"),e=document.createElement("div"),s=document.createElement("h4"),i=document.createElement("form"),o=document.createElement("input");n.default.registerOnElement(t,["click","touchstart"],t=>this.openTab(t,"playerMenu")),t.appendChild(document.createTextNode("Player")),t.classList.add("tabLink"),this.mainMenu.appendChild(t),e.setAttribute("id","playerMenu"),e.classList.add("tabContent"),s.appendChild(document.createTextNode("Player Settings")),i.setAttribute("id","playerSettings"),i.setAttribute("method","post"),o.setAttribute("type","submit"),o.setAttribute("value","Save"),e.appendChild(s),e.appendChild(i),this.element.appendChild(e),Object.keys(this.settings.player).forEach(t=>this.addPlayerSettingEntry(t,i)),i.appendChild(o),i.addEventListener("submit",t=>{t.preventDefault(),this.settings.player.acceleration=Number(document.getElementById("acceleration").value),this.settings.player.maxVelocity=Number(document.getElementById("maxVelocity").value),this.settings.player.friction=Number(document.getElementById("friction").value),this.settings.player.fireDelay=Number(document.getElementById("fireDelay").value),this.clear()})}createAudioMenu(){let t=document.createElement("button"),e=document.createElement("div"),s=document.createElement("div"),i=document.createElement("h4"),o=document.createElement("label"),a=document.createElement("input");n.default.registerOnElement(t,["click","touchstart"],t=>this.openTab(t,"audioMenu")),t.classList.add("tabLink"),t.appendChild(document.createTextNode("Audio")),this.mainMenu.appendChild(t),e.setAttribute("id","audioMenu"),e.classList.add("tabContent"),s.classList.add("row"),i.appendChild(document.createTextNode("Audio Settings")),o.appendChild(document.createTextNode("Master Volume:")),o.setAttribute("for","masterVolume"),a.setAttribute("id","masterVolume"),a.setAttribute("type","range"),a.setAttribute("min","0"),a.setAttribute("max","1"),a.setAttribute("step","0.1"),a.addEventListener("change",t=>this.audioManager.adjustMasterVolume(Number(a.value))),s.appendChild(i),s.appendChild(o),s.appendChild(a),e.appendChild(s);let h=document.createElement("div"),r=document.createElement("label"),d=document.createElement("input");h.classList.add("row"),r.appendChild(document.createTextNode("Ambient Volume:")),r.setAttribute("for","ambientVolume"),d.setAttribute("id","ambientVolume"),d.setAttribute("type","range"),d.setAttribute("min","0"),d.setAttribute("max","1"),d.setAttribute("step","0.1"),d.addEventListener("change",t=>this.audioManager.adjustAmbientVolume(Number(d.value))),h.appendChild(r),h.appendChild(d),e.appendChild(h);let l=document.createElement("div"),u=document.createElement("label"),c=document.createElement("input");l.classList.add("row"),u.appendChild(document.createTextNode("Effects Volume:")),u.setAttribute("for","effectsVolume"),c.setAttribute("id","effectsVolume"),c.setAttribute("type","range"),c.setAttribute("min","0"),c.setAttribute("max","1"),c.setAttribute("step","0.1"),c.addEventListener("change",t=>this.audioManager.adjustEffectsVolume(Number(c.value))),l.appendChild(u),l.appendChild(c),e.appendChild(l),this.element.appendChild(e)}init(){this.createMainMenu(),this.createKeyboardMenu(),this.createPlayerMenu(),this.createAudioMenu()}clear(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.init()}addPlayerSettingEntry(t,e){let s=document.createElement("label"),i=document.createElement("input"),n=document.createElement("div");s.setAttribute("for",t),s.appendChild(document.createTextNode(t+":")),i.setAttribute("id",t),i.setAttribute("type","number"),i.setAttribute("name",t),i.setAttribute("value",this.settings.player[t]),n.classList.add("row"),n.appendChild(s),n.appendChild(i),e.appendChild(n)}addEntry(t,e){let s=document.createElement("div"),i=document.createElement("label"),n=document.createElement("input");s.classList.add("row"),i.setAttribute("for",this.settings.keyBoard[t]),i.appendChild(document.createTextNode(this.settings.keyBoard[t]+":")),n.setAttribute("id",this.settings.keyBoard[t]),n.setAttribute("type","text"),n.setAttribute("name",this.settings.keyBoard[t]),n.setAttribute("value",t),s.appendChild(i),s.appendChild(n),e.appendChild(s)}toggleShow(){this.showing?(this.element.style.display="none",this.showing=!1):(this.element.style.display="block",this.showing=!0)}}},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=s(4),n=s(2);e.default=class{constructor(t){this.keyBoard={w:i.Actions.UP,s:i.Actions.DOWN,a:i.Actions.LEFT,d:i.Actions.RIGHT,space:i.Actions.SHOOT,r:i.Actions.RESTART,q:i.Actions.ROTATE_LEFT,e:i.Actions.ROTATE_RIGHT},this.player={maxVelocity:150,fireDelay:15,friction:.9,acceleration:50},this.audio={master:1,ambient:1,effects:1},this.gameSize=new n.default(t.width,t.height)}findKey(t){return Object.keys(this.keyBoard).filter(e=>this.keyBoard[e]===t)[0]}setKey(t,e){let s=this.findKey(e);t!==s&&(console.log("old:"+s," new: "+t+" value: "+e),this.keyBoard[t]=this.keyBoard[s],delete this.keyBoard[s])}}},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(){this._observers=[],this._state={}}register(t){this._observers.push(t)}unRegister(t){this._observers=this._observers.filter(e=>e!==t)}notify(){this._observers.forEach(t=>{t.update(this._state)})}get observers(){return this._observers}set observers(t){this._observers=t}get state(){return this._state}set state(t){this._state=t}}},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(t){this.quadTree=t}detectCollision(){let t=[];this.quadTree.getAllObjects(t);for(let e=0;e<t.length;e++){let s=[];this.quadTree.findObjects(s,t[e]);for(let i=0;i<s.length;i++)t[e].isCollideAbleWith(s[i])&&Math.floor(t[e].position.x)<Math.floor(s[i].position.x)+s[i].width&&Math.floor(t[e].position.x)+t[e].width>Math.floor(s[i].position.x)&&Math.floor(t[e].position.y)<Math.floor(s[i].position.y)+s[i].height&&Math.floor(t[e].position.y)+t[e].height>Math.floor(s[i].position.y)&&(t[e].colliding=!0,s[i].colliding=!0)}}}},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=s(23),n=s(5);e.default=class{constructor(t,e,s,n,o){this.state=t,this.assetManager=e,this.inputManager=s,this.settings=n,this.canvases=o,this.collisionManager=new i.default(this.state.quadTree),this.contexts=new Map,this.init()}init(){this.canvases.background.getContext&&(this.contexts.set(n.ContextId.BACKGROUND,this.canvases.background.getContext("2d")),this.contexts.set(n.ContextId.SHIP,this.canvases.ship.getContext("2d")),this.contexts.set(n.ContextId.MAIN,this.canvases.main.getContext("2d")),this.contexts.forEach(t=>t.clearRect(0,0,this.settings.gameSize.width,this.settings.gameSize.height))),this.state.entities.forEach(t=>t.init())}clear(){this.state.renderables.forEach(t=>t.clear(this.contexts.get(t.contextId)))}update(t){this.state.quadTree.clear(),this.state.quadTree.insert(this.state.collideables),this.collisionManager.detectCollision(),this.state.movables.forEach(e=>e.move(t))}render(){this.state.renderables.forEach(t=>t.render(this.contexts.get(t.contextId)))}}},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class i{static create(t,e){let s=new XMLHttpRequest;s.addEventListener("load",()=>{e(s.response)}),s.open(t.method?t.method:i.defaults.method,t.url?t.url:i.defaults.url,t.async?t.async:i.defaults.async),t.hasOwnProperty("contentType")&&s.setRequestHeader("Content-Type",t.contentType?t.contentType:i.defaults.contentType),t.hasOwnProperty("responseType")&&(s.responseType=t.responseType),t.hasOwnProperty("data")&&"object"==typeof t.data&&(t.data=JSON.stringify(t.data)),s.send(t.data?t.data:null)}}i.defaults={url:"",method:"GET",contentType:"text/html",async:!0,data:null},e.default=i},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(t,e,s){this._image=t,this._frameWidth=e,this._frameHeight=s,this._framesPerRow=Math.floor(this._image.width/this._frameWidth)}get image(){return this._image}set image(t){if(!(t instanceof Image))throw new Error("Param tileSetImage must be of type Image!");this._image=t}get frameWidth(){return this._frameWidth}set frameWidth(t){this._frameWidth=t}get frameHeight(){return this._frameHeight}set frameHeight(t){this._frameHeight=t}get framesPerRow(){return this._framesPerRow}set framesPerRow(t){this._framesPerRow=t}}},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=s(7),n=s(24),o=s(4),a=s(21),h=s(20),r=s(9),d=s(6),l=s(19),u=s(17),c=s(16),p=new l.default,m=new i.default(p),g={background:document.getElementById("background"),ship:document.getElementById("ship"),main:document.getElementById("main")},y=new a.default(g.background),f=new o.default(y),E=new h.default(document.getElementById("settings-menu"),y,m,p);m.queueDownload(d.AssetId.BACKGROUND,"assets/textures/background.png",i.AssetType.SPRITE),m.queueDownload(d.AssetId.PLAYER,"assets/sprites/ship.png",i.AssetType.SPRITE),m.queueDownload(d.AssetId.PLAYER_BULLET,"assets/sprites/bullet.png",i.AssetType.SPRITE),m.queueDownload(d.AssetId.ENEMY,"assets/sprites/enemy.png",i.AssetType.SPRITE),m.queueDownload(d.AssetId.ENEMY_BULLET,"assets/sprites/bullet_enemy.png",i.AssetType.SPRITE),m.queueDownload(d.AssetId.MAIN_THEME,"assets/audio/kick_shock.wav",i.AssetType.AUDIO),m.queueDownload(d.AssetId.LASER,"assets/audio/laser.wav",i.AssetType.AUDIO),m.queueDownload(d.AssetId.EXPLOSION_I,"assets/audio/explosion.wav",i.AssetType.AUDIO),m.queueDownload(d.AssetId.GAME_OVER,"assets/audio/game_over.wav",i.AssetType.AUDIO),m.downloadAll(()=>{const t=new c.default(y,f,m),e=new n.default(t,m,f,y,g),s=new u.default(e);E.init();let i=document.getElementById("game-over"),o=document.getElementById("settings"),a=document.getElementById("shoot"),h=["click","touchstart"];a.addEventListener("touchstart",()=>f.shoot()),a.addEventListener("touchend",()=>f.cancelShoot()),a.addEventListener("contextmenu",t=>(t.preventDefault(),!1)),r.default.registerOnElement(i,h,()=>s.restart()),r.default.registerOnElement(o,h,()=>{E.toggleShow(),s.togglePause()}),s.start()})}]);
//# sourceMappingURL=invaders.min.js.map